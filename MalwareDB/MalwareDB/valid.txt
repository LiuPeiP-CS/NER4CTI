At O
the O
end O
of O
the O
discovery O
phase O
the B-Entity
attackers I-Entity
should O
know B-Action
the B-Entity
internals I-Entity
of I-Entity
the I-Entity
infected I-Entity
networks I-Entity
and O
have O
identified B-Action
systems B-Entity
with I-Entity
interesting I-Entity
data I-Entity
or I-Entity
with I-Entity
connected I-Entity
industrial I-Entity
control I-Entity
systems I-Entity
. O

On O
the O
USB O
drive O
itself O
, O
the B-Entity
malware I-Entity
would O
hide B-Action
its B-Entity
own I-Entity
files I-Entity
and O
even O
delete B-Action
itself B-Entity
from B-Modifier
it B-Entity
after B-Modifier
three B-Entity
successful I-Entity
propagations I-Entity
. O

We O
also O
observed O
a O
user O
that O
we O
suspect O
works O
for O
NATO O
HQ O
submit O
an O
APT28 O
sample O
to O
VirusTotal O
, O
probably O
as O
a O
result O
of O
receiving O
a O
suspicious O
email O
. O

Less O
than O
a O
week O
after O
this O
announcement O
, O
they O
published O
another O
blog O
post O
that O
describes O
how O
they O
can O
push O
advertising O
to O
specific O
platforms O
, O
devices O
, O
as O
well O
as O
specific O
markets O
and O
networks O
: O
Users O
can O
now O
target O
ads O
to O
a O
specific O
device O
when O
trafficking O
ads O
. O

The B-Entity
installed I-Entity
hook I-Entity
handler I-Entity
calls B-Action
the B-Entity
original I-Entity
API I-Entity
and O
then O
checks B-Action
if B-Entity
the I-Entity
name I-Entity
of I-Entity
the I-Entity
device I-Entity
is I-Entity
netbt I-Entity
or I-Entity
afd I-Entity
. O

Within O
a O
two-week O
window O
, O
'' O
John O
Kasai O
'' O
also O
registered O
the O
following O
domains O
: O
airtravelabroad.com O
, O
beijingnewsblog.net O
, O
grouptumbler.com O
, O
leveldelta.com O
, O
nasdaqblog.net O
, O
natureinhome.com O
, O
nestedmail.com O
, O
nostressjob.com O
, O
nytunion.com O
, O
oilnewsblog.com O
, O
sixsquare.net O
and O
ustradecomp.com O
. O

That O
incident O
, O
observed O
in O
2012 O
, O
also O
used B-Action
hardcoded B-Entity
e-mail I-Entity
to B-Modifier
exfiltrate B-Entity
. O

The O
first O
time O
CHOPSTICK O
is O
executed O
, O
it B-Entity
may O
encrypt B-Action
and I-Action
store I-Action
configuration B-Entity
data I-Entity
in B-Modifier
the B-Entity
Registry I-Entity
key I-Entity
HKU\S-1-5-19Classes\Software\Microsoft\MediaPlayer\ I-Entity
{ I-Entity
E6696105-E63E-4EF1-939E- I-Entity
15DDD83B669A I-Entity
} I-Entity
\chnnl I-Entity
. O

Kim O
Jong O
Un O
officially O
rose O
to O
power O
in O
April O
2012 O
, O
following O
the O
death O
of O
his O
father O
Kim O
Jong O
Il O
in O
December O
2011 O
. O

The O
attackers O
appear O
to O
represent O
a O
single O
entity O
, O
as O
the O
activity O
all O
connects O
back O
to O
accounts O
that O
sent O
links O
shortened O
using O
a O
par- O
ticular O
user O
account O
al9mood O
on O
the O
bit.ly O
URL O
shortening O
service O
. O

In O
turn O
, O
these B-Entity
exploits I-Entity
downloaded B-Action
and O
decoded O
a B-Entity
payload I-Entity
hosted I-Entity
at I-Entity
: I-Entity
hxxp I-Entity
: I-Entity
//103.27.108.45/img/js.php I-Entity
. O

On O
August O
25 O
, O
2014 O
, O
the O
version O
compiled O
on O
August O
18 O
was O
submitted O
to O
VirusTotal O
in O
a O
ZIP O
archive O
located O
at O
http O
: O
//dl.doosan-job O
( O
dot O
) O
com/cv/EasyResumeCreator- O
v2.0.zip O
. O

For O
instance O
, O
if O
the O
attackers O
set O
up O
a O
zhCat O
instance O
listening O
on O
port O
1000 O
on O
192.168.116.128 O
in O
HTTP O
mode O
, O
the O
client O
instance O
of O
zhCat O
would O
use O
the O
following O
command O
: O
The O
server O
instance O
would O
use O
the O
following O
command O
: O
When O
we O
run O
both O
of O
these O
, O
we O
can O
send O
information O
just O
by O
typing O
it O
into O
the O
terminal O
of O
the O
running O
application O
. O

The B-Entity
c I-Entity
& I-Entity
c I-Entity
servers I-Entity
used B-Action
by O
the B-Entity
attackers I-Entity
revealed O
a O
lot O
of O
interesting O
files O
stored O
in O
various O
folders O
: O
This O
is O
quite O
the O
usual O
arsenal O
for O
a O
group O
of O
APT O
attackers O
: O
What O
is O
rare O
to O
find O
is O
the O
controller O
part O
of O
those O
tools O
. O

The B-Entity
C I-Entity
& I-Entity
C I-Entity
operations I-Entity
are B-Action
undertaken I-Action
by O
various B-Entity
modules I-Entity
, O
including O
major O
groups O
C373h O
, O
19h O
, O
9 O
, O
as O
well O
as O
Stage O
5 O
payloads O
, O
such O
as O
C375h O
and O
1Bh O
. O

A O
webpage O
published O
on O
a O
Chinese O
government O
site O
detailing O
theatrical O
performances O
involving O
members O
of O
the O
PLA O
lists O
an O
address O
of O
'' O
闸北区粤秀路46号 O
'' O
( O
46 O
Yue O
Xiu O
Road O
, O
Zhabei O
District O
) O
for O
'' O
总参61486部队 O
'' O
( O
61486 O
Forces O
General O
Staff O
) O
. O

This O
map O
is O
not O
complete O
, O
though O
. O

Within O
the O
video O
, O
the O
cyber O
ranges O
were O
referenced O
as O
being O
developed O
for O
'' O
defense O
forces O
'' O
that O
were O
aimed O
to O
'' O
help O
them O
in O
developing O
offensive O
and O
defensive O
warfare O
skills O
'' O
and O
'' O
combating O
anti-state O
hackers O
'' O
. O

This O
system O
( O
s O
) O
uses O
a O
'' O
Dave O
'' O
user O
account O
and O
'' O
HOME­OFF­D5F0AC O
'' O
Windows O
system O
name O
. O

There O
is O
even O
a O
small O
possibility O
that O
the O
phenomenon O
is O
a O
pure O
artifact O
; O
for O
example O
that O
a O
Spanish-speaking O
researcher O
connected O
to O
the O
same O
account O
using O
the O
same O
Linux-based O
setup O
as O
the O
attackers O
. O

In O
the O
above O
cases O
, O
save O
Turkey O
, O
the O
country O
we O
have O
identi- O
fied O
is O
classified O
as O
an O
'' O
authoritarian O
regime O
, O
'' O
and O
may O
be O
using O
Hacking O
Team O
products O
against O
the O
types O
of O
targets O
we O
profile O
in O
this O
paper O
. O

In O
either O
case O
, O
the B-Entity
driver I-Entity
obtains O
the O
device O
object O
by O
using O
IoGetDeviceObjectPointer O
( O
) O
and O
hooks B-Action
Major B-Entity
Function I-Entity
14 I-Entity
the I-Entity
IRPMJDEVICECONTROL I-Entity
, O
as O
this O
is O
the O
function O
through O
which O
all O
Input O
Output O
ConTroLls O
( O
IOCTLs O
) O
are O
sent O
, O
such O
as O
the O
IOCTL O
for O
querying O
active O
IP O
connections O
. O

] O
com O
domain O
previously O
resolved O
to O
58.64.199.22 O
. O

Contact O
: O
intelreports O
@ O
kaspersky.com O
The O
attacks O
in O
this O
campaign O
fall O
into O
several O
different O
categories O
depending O
on O
the O
vector O
used O
in O
the O
initial O
compromise O
: O
The B-Entity
attackers I-Entity
use B-Action
both B-Entity
direct I-Entity
spearphishing I-Entity
and I-Entity
watering I-Entity
hole I-Entity
attacks I-Entity
to B-Modifier
infect B-Entity
their I-Entity
victims I-Entity
. O

For O
example O
, O
there O
are O
cases O
where O
the O
developer O
failed O
( O
intentionally O
or O
unintentionally O
) O
to O
check O
the O
server O
's O
certificate O
. O

Although O
superficially O
the O
discussion O
is O
about O
cars O
, O
there O
is O
a O
repeated O
word O
in O
the O
text O
, O
'' O
milk O
yellow O
package O
'' O
or O
'' O
custard O
package O
'' O
or O
'' O
yoke O
package O
'' O
( O
奶黄包 O
) O
. O

We O
have O
been O
able O
to O
decrypt O
the O
communications O
and O
confirmed O
what O
is O
transmitted O
to O
the O
c O
& O
c O
server O
. O

In O
early O
2014 O
, O
our O
researchers O
exposed O
their O
use O
of O
cve­2014­0497 O
, O
a O
Flash O
0-day O
described O
on O
Securelist O
in O
early O
February O
. O

4 O
. O

Red O
Star O
OS O
's O
keyboard O
layouts O
include O
Korean O
, O
English O
, O
Russian O
, O
Chinese O
, O
and O
Japanese O
. O

On O
the O
surface O
, O
BITTERBUG O
serves O
as O
an O
example O
of O
how O
threat O
actors O
mask O
their O
operations O
across O
social O
, O
cultural O
and O
geographic O
boundaries O
. O

Of O
note O
, O
the O
email O
message O
was O
sent O
with O
an O
X-Originating O
IP O
Address O
of O
184.75.214.10 O
corresponding O
to O
a O
Private O
Internet O
Access O
Canadian O
proxy O
. O

The B-Entity
export I-Entity
'CollectW3PerfData I-Entity
' I-Entity
is B-Action
registered I-Action
as B-Modifier
the B-Entity
main I-Entity
function I-Entity
of I-Entity
the I-Entity
DLL I-Entity
. O

The O
digitallinx.net/Contact.html O
identified O
similar O
overlaps O
with O
data O
across O
the O
.org O

He O
also O
re- O
ports O
that O
his O
car O
was O
stolen O
, O
a O
large O
sum O
of O
money O
disappeared O
from O
his O
bank O
account O
, O
and O
his O
passport O
was O
confiscated O
. O

This O
is O
another O
reason O
why O
expansion O
of O
CNO O
capabilities O
using O
the O
nation O
's O
own O
infrastructure O
seems O
unlikely O
in O
the O
foreseeable O
future O
. O

Just O
like O
with O
RedOctober O
, O
the O
top O
target O
of O
Cloud O
Atlas O
is O
Russia O
, O
followed O
closely O
by O
Kazakhstan O
, O
according O
to O
data O
from O
the O
Kaspersky O
Security O
Network O
( O
KSN O
) O
. O

Once O
ROP O
marks O
the O
shellcode O
as O
executable O
using O
Windows O
' O
VirtualProtect O
function O
, O
it B-Entity
downloads B-Action
an B-Entity
executable I-Entity
via B-Modifier
the B-Entity
InternetOpenURLA I-Entity
and I-Entity
InternetReadFile I-Entity
functions I-Entity
. O

Historically O
, O
dreems.no-ip.ca O
also O
resolved O
to O
this O
address O
. O

PVZ O
is O
a O
name O
for O
a O
set O
of O
executables O
used O
together O
to O
create O
a O
botnet O
. O

Fortunately O
the O
power O
plant O
was O
already O
offline O
due O
to O
maintenance O
and O
the O
installed O
secondary O
backup O
monitoring O
system O
was O
unaffected O
by O
the O
worm O
. O

This O
is O
one O
instance O
where O
the O
malvertiser O
wasted O
his O
65 O
cents O
. O

The O
social O
engineering O
messages O
concentrated O
mainly O
around O
the O
following O
two O
themes O
: O
Once O
installed B-Action
, O
the B-Entity
back I-Entity
door I-Entity
would O
create B-Action
a B-Entity
registry I-Entity
run I-Entity
key I-Entity
in O
order O
to O
restart B-Action
with B-Modifier
Windows B-Entity
and O
connect B-Action
to B-Modifier
one B-Entity
of I-Entity
three I-Entity
C I-Entity
& I-Entity
C I-Entity
servers I-Entity
located I-Entity
in I-Entity
Greece I-Entity
. O

Following O
his O
rise O
to O
power O
, O
the O
regime O
reportedly O
expanded O
its O
labor O
camps O
, O
and O
more O
military O
resources O
were O
allocated O
to O
target O
those O
attempting O
to O
defect O
. O

In O
some O
variants O
, O
BITTERBUG B-Entity
has O
the O
ability O
to O
automatically O
target B-Action
and I-Action
exfiltrate I-Action
files B-Entity
with I-Entity
extensions I-Entity
such I-Entity
as I-Entity
.doc I-Entity
, I-Entity
.xls I-Entity
, I-Entity
.pdf I-Entity
, I-Entity
.ppt I-Entity
, I-Entity
.egm I-Entity
, I-Entity
and I-Entity
.xml I-Entity

The B-Entity
executable I-Entity
is B-Action
also I-Action
installed I-Action
into B-Modifier
the B-Entity
ASEP I-Entity
registry I-Entity
key I-Entity
HKCU\Software\Microsoft\Windows\ I-Entity
CurrentVersion\Run I-Entity
, O
with B-Modifier
a B-Entity
value I-Entity
named I-Entity
McUpdate I-Entity
. O

The O
event O
tree O
in O
Figure O
2 O
taken O
from O
Invincea O
's O
Threat O
Management O
Console O
shows O
the B-Entity
exploited I-Entity
Java I-Entity
process I-Entity
dropped B-Action
a B-Entity
file I-Entity
called I-Entity
fvJcrgR0.exe I-Entity
, O
and O
that O
it O
likely O
came O
from O
Pubmatic O
, O
an O
ad O
delivery O
network O
that O
allows O
for O
real O
time O
bidding O
to O
deliver O
ads O
. O

Although O
Tranchulas O
brands O
itself O
as O
a O
multi-national O
company O
, O
their O
respective O
operating O
addresses O
within O
United O
Kingdom O
the O
United O
States O
and O
New O
Zealand O
are O
all O
associated O
with O
either O
virtual O
office O
spaces O
or O
address O
forwarding O
services O
. O

Symantec O
offers O
the O
following O
protection O
against O
attacks O
associated O
with O
Operation O
CloudyOmega O
: O
Less O
than O
a O
week O
after O
uncovering O
Operation O
SnowMan O
, O
the O
FireEye O
Dynamic O
Threat O
Intelligence O
cloud O
has O
identified O
another O
targeted O
attack O
campaign O
- O
this O
one O
exploiting O
a O
zero-day O
vulnerability O
in O
Flash O
. O

The O
TinyZBot O
included O
was O
the O
version O
compiled O
on O
June O
7 O
, O
2014 O
. O

It O
should O
be O
noted O
, O
that O
we O
believe O
all O
five O
domains O
contacted O
by O
the O
malware O
are O
innocent O
websites O
compromised O
by O
the O
malware O
operators O
, O
not O
dedicated O
malicious O
servers O
. O

In O
the O
energy O
sector O
the O
most O
commonly O
used O
theme O
for O
spear O
phishing O
emails O
was O
money O
related O
( O
e.g O
. O

] O
org O
and O
book O
[ O
. O

] O
com O
and O
thebesttothbrushes O
[ O
. O

Another B-Entity
dropper I-Entity
has O
been O
observed O
, O
exclusively O
installing B-Action
the B-Entity
pngdowner I-Entity
malware I-Entity
( I-Entity
example I-Entity
MD5 I-Entity
hash I-Entity
4c50457c35e2033b3a03fcbb4adac7b7 I-Entity
) I-Entity
. O

This B-Entity
group I-Entity
's O
primary O
goal O
is O
to O
steal B-Action
confidential B-Entity
information I-Entity
from B-Modifier
targeted B-Entity
organizations I-Entity
. O

How O
can O
Neustar O
IP O
Intelligence O
target O
by O
IP O
? O
While O
IP O
intelligence O
has O
been O
around O
for O
many O
years O
, O
the O
ability O
to O
effectively O
target O
advertising O
by O
audience O
, O
based O
on O
IP O
is O
very O
new O
. O

The O
reflection O
effects O
observed O
on O
the O
windows O
of O
this O
building O
could O
be O
due O
to O
coatings O
applied O
to O
resist O
eavesdropping O
via O
laser O
microphones O
and O
to O
increase O
privacy O
, O
which O
would O
be O
consistent O
with O
a O
military O
installation O
conducting O
sensitive O
work O
. O

The B-Entity
backdoor I-Entity
additionally O
replaced B-Action
the B-Entity
original I-Entity
malicious I-Entity
executable I-Entity
with B-Modifier
an B-Entity
appropriately I-Entity
named I-Entity
image I-Entity
file I-Entity
and O
padded B-Action
the B-Entity
image I-Entity
file I-Entity
with B-Modifier
null B-Entity
bytes I-Entity
in B-Modifier
order I-Modifier
to I-Modifier
mirror B-Entity
the I-Entity
original I-Entity
file I-Entity
size I-Entity
. O

The O
framework O
is O
generic O
, O
and O
will O
work O
as O
an O
attack O
platform O
for O
a O
multitude O
of O
purposes O
with O
very O
little O
modification O
. O

Known O
tactics O
, O
techniques O
and O
procedures O
Targets O
WhoIs O
Team O
is O
one O
of O
two O
groups O
that O
claimed O
responsibility O
for O
the O
'' O
March O
20 O
'' O
attacks O
targeting O
South O
Korea O
. O

Adobe O
has O
assigned O
the O
CVE O
identifier O
CVE-2014- O
0502 O
to O
this O
vulnerability O
and O
released O
a O
security O
bulletin O
. O

At O
the O
time O
, O
a O
Chinese O
delegation O
led O
by O
Keqiang O
was O
visiting O
Greek O
Prime O
Minister O
Antonis O
Samaras O
in O
Athens O
. O

In O
the O
event O
tree O
shown O
in O
Figure O
7 O
, O
you O
will O
see O
that O
the O
winning O
bid O
redirected O
to O
a O
direct-to-IP O
site O
instead O
of O
a O
site O
via O
domain O
name O
. O

Web O
and O
the O
UAE O
RCS O
sample O
sent O
to O
Ahmed O
. O

A O
RAT O
would O
have O
provided O
much O
greater O
access O
alongside O
IP O
information O
By O
not O
providing O
remote O
access O
and O
other O
RAT O
functionality O
, O
the B-Entity
program I-Entity
looks B-Action
less B-Entity
like I-Entity
malware I-Entity
, O
and O
may O
attract B-Action
less B-Entity
attention I-Entity
from O
endpoint O
protection O
tools O
and O
scanners O
. O

Some O
researchers O
have O
started O
to O
create O
honey O
pot O
systems O
in O
order O
to O
study O
the O
attackers O
, O
which O
have O
apparently O
already O
attracted O
attackers O
like O
the O
Comment O
Crew/APT1 O
group O
, O
who O
have O
broken O
into O
these O
decoy O
systems O
. O

As O
we O
will O
discuss O
later O
, O
the O
3rd O
party O
ad O
networks O
themselves O
are O
falling O
victim O
to O
malicious O
content O
campaigns O
. O

Logger B-Entity
Module I-Entity
observes B-Action
the B-Entity
user I-Entity
's I-Entity
actions I-Entity
and O
records B-Action
them B-Entity
to B-Modifier
a B-Entity
file I-Entity
. O

The O
Reserve O
Military O
Training O
Unit O
forms O
the O
core O
of O
North O
Korea O
's O
reserves O
and O
is O
typically O
assigned O
to O
the O
front O
or O
regional O
defense O
in O
wartime O
. O

During O
that O
time O
period O
, O
the B-Entity
Chinese I-Entity
hacking I-Entity
community I-Entity
engaged B-Action
in B-Modifier
website O
defacements O
and O
denial B-Entity
of I-Entity
service I-Entity
attacks I-Entity
in O
conjunction O
with O
incidents O
such O
as O
the O
accidental O
bombing O
of O
the O
Chinese O
embassy O
in O
Belgrade O
in O
1999 O
, O
the O
collision O
of O
a O
U.S. O
spy O
plane O
and O
a O
Chinese O
military O
plane O
in O
2001 O
, O
and O
the O
Japanese O
Prime O
Minister O
's O
controversial O
visit O
to O
the O
Yasukuni O
shrine O
in O
2005 O
. O

As O
seen O
in O
the O
July O
2009 O
attacks O
on O
South O
Korean O
and O
U.S. O
targets O
, O
North O
Korea O
has O
leveraged O
networks O
in O
countries O
such O
as O
Austria O
, O
Georgia O
, O
Germany O
, O
and O
even O
South O
Korea O
and O
the O
U.S. O
, O
in O
order O
to O
launch O
cyber O
attacks O
. O

A O
more O
subtle O
change O
is O
the O
renaming O
of O
the O
'' O
socks5 O
'' O
command O
to O
simply O
'' O
proxy O
'' O
within O
the O
code O
. O

The O
attackers O
behind O
Epic O
Turla O
have O
infected O
several O
hundred O
computers O
in O
more O
than O
45 O
countries O
, O
including O
government O
institutions O
, O
embassies O
, O
military O
, O
education O
, O
research O
and O
pharmaceutical O
companies O
. O

The O
following O
sections O
detail O
the O
changes O
to O
Backdoor.APT.Aumlib O
and O
Backdoor.APT.Ixeshe O
. O

The O
Driver O
component O
of O
Gen O
1 O
Hikit O
variants O
provides O
the O
interface O
between O
the O
victim O
's O
network O
interface O
card O
( O
NIC O
) O
and O
the O
DLL O
. O

This O
is O
the O
same O
registrant O
record O
for O
the O
digitallinx.net O
domain O
. O

The B-Entity
malware I-Entity
then O
requests B-Action
a B-Entity
connection I-Entity
to I-Entity
192.184.60.229 I-Entity
on I-Entity
TCP I-Entity
port I-Entity
81 I-Entity
using B-Modifier
the B-Entity
command I-Entity
'' I-Entity
05 I-Entity
01 I-Entity
00 I-Entity
01 I-Entity
c0 I-Entity
b8 I-Entity
3c I-Entity
e5 I-Entity
00 I-Entity
51 I-Entity
'' I-Entity
and O
verifies B-Action
that B-Modifier
the B-Entity
first I-Entity
two I-Entity
bytes I-Entity
from I-Entity
the I-Entity
server I-Entity
are I-Entity
'' I-Entity
05 I-Entity
00 I-Entity
'' I-Entity
( O
c0 O
b8 O
3c O
e5 O
is O
the O
IP O
address O
and O
00 O
51 O
is O
the O
port O
in O
network O
byte O
order O
) O
. O

After O
that O
comes O
the O
discovery O
phase O
, O
where O
the B-Entity
attacker I-Entity
gathers B-Action
passwords B-Entity
and O
maps B-Action
the B-Entity
internal I-Entity
network I-Entity
. O

This O
torrent O
serves O
up O
an O
almost O
900 O
mb O
file O
. O

Individuals O
using O
the O
outward-facing O
Internet O
connection O
must O
be O
authorized O
. O

] O
com O
, O
and O
cht O
[ O
. O

These O
are O
just O
a O
few O
examples O
of O
the O
myriad O
of O
forensic O
details O
that O
we O
consider O
when O
distinguishing O
one O
threat O
group O
from O
another O
. O

However O
, O
according O
to O
Google O
, O
by O
7 O
July O
2014 O
, O
17.9 O
% O
Android O
devices O
are O
using O
Android O
4.4 O
. O

In O
April O
2009 O
, O
North O
Korea O
ejected O
IAEA O
and O
U.S. O
nuclear O
compliance O
officials O
. O

Interestingly O
, O
this O
would O
suggest O
two O
very O
different O
targeting O
strategies O
. O

Any O
credentials O
found O
are O
reported O
back O
to O
the O
original O
infection O
. O

With O
their O
knowhow O
about O
internal O
critical O
processes O
and O
systems O
they O
often O
know O
how O
to O
inflict O
serious O
damage O
. O

When O
decrypted O
, O
these O
turned O
out O
to O
be O
dropper B-Entity
packages I-Entity
containing B-Action
one B-Entity
dropper I-Entity
executable I-Entity
clearly I-Entity
created I-Entity
for I-Entity
the I-Entity
Inception I-Entity
framework I-Entity
, I-Entity
and I-Entity
one I-Entity
other I-Entity
, I-Entity
very I-Entity
different I-Entity
executable I-Entity
. O

Article O
58 O
of O
the O
North O
Korean O
Constitution O
states O
that O
the O
nation O
should O
base O
itself O
on O
a O
nationwide O
defense O
system O
that O
includes O
all O
people O
. O

He O
then O
'' O
burns O
'' O
his O
temporary O
exploit O
kit O
drop O
site O
, O
moving O
his O
exploits O
to O
another O
location O
for O
a O
new O
campaign O
. O

Other O
known O
mutexes O
used O
by O
older O
and O
current O
variants O
include O
: O
The B-Entity
malware I-Entity
configuration I-Entity
file I-Entity
is B-Action
written I-Action
to B-Modifier
the B-Entity
'' I-Entity
SYSTEM I-Entity
'' I-Entity
folder I-Entity
( I-Entity
as I-Entity
opposed I-Entity
to I-Entity
SYSTEM32 I-Entity
) I-Entity
and O
has O
a O
slightly O
new O
format O
compared O
to O
'' O
older O
'' O
NetTraveler O
samples O
: O
For O
the O
record O
, O
here O
's O
what O
an O
older O
NetTraveler O
config O
file O
looks O
like O
: O
Obviously O
, O
the B-Entity
developers I-Entity
behind I-Entity
NetTraveler I-Entity
have O
taken O
steps O
to O
try O
to O
hide B-Action
the B-Entity
malware I-Entity
's I-Entity
configuration I-Entity
. O

This O
vulnerability O
which O
exists O
on O
some O
old O
versions O
of O
OpenSSL O
allows O
attackers B-Entity
to O
collect B-Action
data B-Entity
from B-Modifier
chunks B-Entity
of I-Entity
memory I-Entity
from I-Entity
the I-Entity
targeted I-Entity
machine I-Entity
. O

This O
can O
prevent O
attackers O
from O
reaching O
internal O
systems O
. O

The B-Entity
configuration I-Entity
can O
also O
be B-Action
updated I-Action
on O
the O
fly O
by O
the B-Entity
attackers I-Entity
, O
via B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
. O

WndTest B-Entity
installs B-Action
as B-Modifier
a B-Entity
service I-Entity
and O
has O
been O
observed O
attempting O
to O
impersonate B-Action
Adobe B-Entity
Report I-Entity
Service I-Entity
. O

The B-Entity
attackers I-Entity
successfully O
de- B-Action
leted I-Action
traces B-Entity
of I-Entity
their I-Entity
work I-Entity
from B-Modifier
earlier B-Entity
attacks I-Entity
in I-Entity
another I-Entity
hotel I-Entity
, O
but O
their O
offensive O
techniques O
were O
the O
same O
. O

Accord- O
ing O
to O
these O
, O
the O
e-mails O
received O
by O
the O
targets O
all O
came O
from O
fatoomah85 O
@ O
gmail.com O
. O

It O
is O
clear O
that O
this O
infrastructure O
model O
does O
not O
need O
to O
be O
applied O
solely O
against O
a O
few O
targets O
, O
or O
even O
need O
to O
be O
hosted O
at O
CloudMe O
. O

It O
is O
through O
this O
process O
that O
a O
shared O
awareness O
emerges O
into O
a O
larger O
, O
more O
comprehensive O
story O
that O
explains O
what O
we O
are O
seeing O
and O
why O
- O
ultimately O
it O
is O
this O
story O
that O
better O
serves O
us O
all O
. O

The B-Entity
executable I-Entity
14c04f88dc97aef3e9b516ef208a2bf5 I-Entity
is O
commonly O
referred O
to O
as O
a O
'dropper O
' O
, O
which O
is O
designed O
with O
the O
purpose O
of O
extracting B-Action
from B-Modifier
itself B-Entity
a B-Entity
malicious I-Entity
payload I-Entity
and O
to O
initialize B-Action
and I-Action
install I-Action
it B-Entity
into B-Modifier
a B-Entity
targeted I-Entity
system I-Entity
. O

Anecdotally O
, O
campaign O
volume O
appears O
to O
track O
significant O
events O
in O
the O
ongoing O
conflict O
. O

The O
C2 O
location O
in O
this O
sample O
is O
statically O
defined O
as O
1.9.5.38:443 O
( O
Malaysia O
: O
Tmnet O
, O
Telekom O
Malaysia O
Bhd O
) O
. O

'' O
EY O
'' O
could O
stand O
for O
'' O
Ernst O
& O
Young O
'' O
. O

Real O
time O
bidding O
transactions O
typically O
happen O
within O
100 O
milliseconds O
from O
the O
moment O
the O
ad O
exchange O
received O
the O
request O
. O

We O
will O
definitely O
keep O
our O
ears O
and O
eyes O
open O
and O
continue O
analyzing O
. O

When O
a O
user O
attempts O
to O
download O
an O
executable O
via O
the O
malicious O
Tor O
exit O
node O
, O
what O
they O
actually O
receive O
is O
an O
executable O
'' O
wrapper O
'' O
that O
embeds O
both O
the O
original O
executable O
and O
a O
second O
, O
malicious O
executable O
. O

The B-Entity
code I-Entity
simply O
brute B-Action
forces I-Action
the B-Entity
list I-Entity
of I-Entity
mapped I-Entity
removable I-Entity
drives I-Entity
. O

It O
is O
a O
well-known O
challenge O
for O
an O
attacker O
to O
call O
Android O
services O
from O
injected O
native O
code O
that O
does O
n't O
have O
Android O
application O
context O
. O

There O
are O
tens O
of O
thousands O
of O
down- O
loads O
of O
these O
individual O
torrents O
. O

All B-Entity
of I-Entity
these I-Entity
infected I-Entity
files I-Entity
drop B-Action
a B-Entity
63kb I-Entity
self I-Entity
injecting I-Entity
compo- I-Entity
nent I-Entity
. O

Many O
of O
these O
were O
submitted O
to O
online O
malware O
analysis O
websites O
by O
victims O
and O
investigators O
over O
several O
years O
. O

Bdagent.exe O
is O
a O
name O
for O
BitDefender O
Antivirus O
component O
. O

First O
, O
Kim O
Jong O
Un O
's O
personal O
life O
is O
more O
public O
and O
more O
extravagant O
than O
that O
of O
his O
father O
. O

MiniDuke O
was O
first O
discussed O
by O
Kaspersky O
in O
March O
2013 O
in O
their O
paper O
The O
MiniDuke O
Mystery O
: O
PDF O
0- O
day O
Government O
Spy O
Assembler O
0x29A O
Micro O
Backdoorand O
shortly O
after O
in O
a O
paper O
by O
Bitdefender O
. O

In O
addition O
to O
this O
, O
the O
rate O
of O
attack O
exposure O
has O
also O
risen O
, O
with O
more O
companies O
becoming O
aware O
of O
attacks O
, O
expecting O
them O
and O
searching O
for O
indications O
of O
compromise O
. O

Unfortunately O
, O
many O
critical O
infrastructure O
organizations O
are O
unable O
to O
secure O
their O
complex O
envirnoments O
against O
modern O
attacks O
. O

Regin O
is O
different O
to O
what O
are O
commonly O
referred O
to O
as O
'' O
traditional O
'' O
advanced O
persistent O
threats O
( O
APTs O
) O
, O
both O
in O
its O
techniques O
and O
ultimate O
purpose O
. O

it O
does O
n't O
match O
the O
specified O
version O
) O
, O
the B-Entity
DLL I-Entity
installs B-Action
the B-Entity
version I-Entity
of I-Entity
the I-Entity
Driver I-Entity
found I-Entity
within I-Entity
the I-Entity
DLL I-Entity
's I-Entity
resource I-Entity
section I-Entity
( I-Entity
under I-Entity
the I-Entity
BIN I-Entity
resource I-Entity
tree I-Entity
) I-Entity
. O

 O
North O
Korea O
is O
well-isolated O
from O
the O
outside O
world O
, O
and O
its O
strong O
intelligence O
and O
psychological O
operations O
presence O
effectively O
creates O
confusion O
via O
counterintelligence O
and O
disinformation O
about O
the O
regime O
's O
capabilities O
. O

Our O
analysis O
indicates O
this O
is O
a O
sophisticated O
multi-stage O
infection O
; O
which O
begins O
with O
Epic O
Turla O
. O

We O
also O
observed O
30 O
active O
servers O
used O
a O
global O
IPID O
. O

For O
example O
, O
some B-Entity
malware I-Entity
samples I-Entity
will O
send B-Action
the B-Entity
data I-Entity
in B-Modifier
smaller B-Entity
bursts I-Entity
so B-Modifier
as I-Modifier
not B-Entity
to I-Entity
swamp I-Entity
the I-Entity
network I-Entity
or I-Entity
generate I-Entity
network I-Entity
spikes I-Entity
that I-Entity
might I-Entity
attract I-Entity
attention I-Entity
. O

Both B-Entity
the I-Entity
internal I-Entity
strings I-Entity
and I-Entity
logic I-Entity
are B-Action
obfuscated I-Action
and O
are O
unpacked O
at O
startup O
. O

Under O
default O
security O
settings O
, O
Office O
disables O
all O
unsigned O
macros O
, O
so O
that O
a O
user O
who O
opens O
the O
document O
will O
only O
see O
an O
informational O
message O
that O
the O
macro O
has O
been O
disabled O
. O

using B-Modifier
command B-Entity
identifiers I-Entity
0x20000002 I-Entity
to I-Entity
0x20000019 I-Entity
. O

It O
is O
probably O
no O
coincidence O
that O
Monday O
, O
Feb. O
17 O
, O
is O
a O
U.S. O
holiday O
, O
and O
much O
of O
the O
U.S. O
Capitol O
shut O
down O
Thursday O
amid O
a O
severe O
winter O
storm O
. O

The O
following O
iteration O
compiled O
on O
March O
12 O
, O
2013 O
, O
only O
contained O
minor O
bug O
fixes O
. O

This O
address O
was O
un- O
reachable O
when O
we O
probed O
it O
; O
a O
researcher O
pointed O
us O
to O
an B-Entity
FS- I-Entity
BSpy I-Entity
sample I-Entity
that O
contained B-Action
an B-Entity
Arabic-language I-Entity
bait I-Entity
document I-Entity
about I-Entity
Omani I-Entity
poetry I-Entity
, O
which O
talked B-Action
to B-Modifier
a B-Entity
C I-Entity
& I-Entity
C I-Entity
in I-Entity
the I-Entity
UK I-Entity
. O

The O
earliest O
Gen O
2 O
sample O
known O
to O
exist O
dates O
to O
28 O
August O
2011 O
, O
two O
months O
before O
the O
first O
known O
Gen O
1.2 O
sample O
. O

FireEye O
strongly O
recommends O
updating O
Microsoft O
Office O
2007 O
and O
2010 O
with O
the O
latest O
patches O
. O

This O
blog O
gives O
an O
overview O
of O
the O
first O
one O
, O
related O
to O
Afghanistan O
& O
Tajikistan O
. O

It O
then O
adds O
this O
index O
to O
the O
value O
of O
KeServiceDescriptorTable.Base O
, O
which O
is O
the O
exported O
kernel O
variable O
( O
on O
32-bit O
Windows O
only O
) O
which O
directly O
points O
to O
the O
system O
call O
table O
. O

This O
other O
company O
could O
be O
a O
partner O
or O
competitor O
. O

This B-Entity
PlugX I-Entity
variant I-Entity
connected B-Action
to B-Modifier
a B-Entity
Google I-Entity
Code I-Entity
project I-Entity
at I-Entity
code.google I-Entity
[ I-Entity
. I-Entity
] I-Entity
com/p/udom/ I-Entity
, O
where O
it B-Entity
decoded B-Action
a B-Entity
command I-Entity
that I-Entity
configured I-Entity
its I-Entity
C2 I-Entity
server I-Entity
. O

The O
full O
malware O
report O
is O
included O
in O
Appendix O
A O
: O
Malware O
Details O
. O

We O
have O
contacted O
national O
CERTs O
to O
notify O
the O
affected O
parties O
. O

Symantec O
first O
began O
looking O
into O
this O
threat O
in O
the O
fall O
of O
2013 O
. O

ARP B-Entity
hijacking I-Entity
is B-Action
a B-Entity
well-known I-Entity
approach I-Entity
used I-Entity
in I-Entity
network I-Entity
attacks I-Entity
. O

A O
Python O
implementation O
of O
the O
algorithm O
can O
be O
found O
in O
Appendix O
B O
. O

Destructive O
Target O
Cleaning O
Tool O
: O
This B-Entity
tool I-Entity
renders B-Action
victim B-Entity
machines I-Entity
inoperable B-Entity
by O
overwriting B-Action
the B-Entity
Master I-Entity
Boot I-Entity
Record I-Entity
. O

It O
then O
calls O
either O
the O
original O
or O
copy O
of O
regsvr32.exe O
with O
the O
parameters O
/s O
/u O
and O
the O
path O
to O
the O
copy O
of O
itself O
it O
made O
in O
Step O
1 O
. O

The B-Entity
attacks I-Entity
include B-Action
spyware B-Entity
for I-Entity
ongoing I-Entity
monitoring I-Entity
and O
the B-Entity
use I-Entity
of I-Entity
'' I-Entity
IP I-Entity
spy I-Entity
'' I-Entity
links I-Entity
to I-Entity
deanonymize I-Entity
those I-Entity
who I-Entity
voice I-Entity
dissent I-Entity
. O

The B-Entity
communication I-Entity
between I-Entity
the I-Entity
processes I-Entity
is B-Action
performed I-Action
by O
named B-Entity
pipe I-Entity
. O

Not O
only O
is B-Action
it B-Entity
exceptionally B-Entity
targeted I-Entity
, O
but O
it O
is O
also O
not O
a O
commonly O
available O
RAT O
. O

As O
TinyZBot O
is O
developed O
in O
C O
# O
, O
many O
versions O
can O
be O
decompiled O
to O
code O
very O
similar O
to O
their O
originals O
, O
including O
names O
of O
namespaces O
. O

HIPS O
( O
host O
based O
intrusion O
prevention O
systems O
) O
, O
behavioral O
lockdown O
or O
whitelisting O
can O
protect O
computers O
from O
any O
kind O
of O
unwanted O
tampering O
without O
the O
need O
of O
constant O
updates O
. O

This O
architecture O
is O
designed O
to O
grant O
Snake O
as O
much O
flexibility O
as O
possible O
. O

We O
frame O
the O
nature O
of O
these O
attacks O
, O
and O
the O
technology O
and O
infrastructure O
used O
to O
conduct O
them O
, O
in O
the O
con- O
text O
of O
their O
impacts O
on O
real O
people O
. O

At O
the O
moment O
only O
one O
exists O
, O
@ O
AA2ADcAOAA O
, O
which O
is O
the O
TwitterJS O
account O
that O
was O
generated O
between O
August O
21st O
and O
27th O
2013 O
. O

The O
image O
below O
shows O
the O
beginning O
of O
the O
CVE-2012-0158 O
shellcode O
in O
ASCII O
encoding O
within O
the O
document O
( O
the O
opcodes O
60 O
, O
55 O
, O
8bec O
disassemble O
to O
pusha O
; O
push O
ebp O
; O
mov O
ebp O
, O
esp O
) O
. O

Perhaps O
the O
most O
unusual O
fact O
was O
that O
the O
Microsoft O
Office O
exploit O
did O
n't O
directly O
write O
a O
Windows O
PE O
backdoor O
on O
disk O
. O

In O
a O
June O
2014 O
Reddit O
AMA O
session O
, O
Dr. O
Andrei O
Lankov O
, O
an O
expert O
on O
North O
Korean O
culture O
and O
society O
, O
noted O
'' O
there O
are O
also O
serious O
signs O
of O
public O
alienation O
and O
discontent O
. O

Two B-Entity
similar I-Entity
applications I-Entity
were O
developed O
by O
Operation O
Cleaver O
in O
order O
automate B-Action
the B-Entity
execution I-Entity
of I-Entity
Mimikatz I-Entity
. O

Those O
campaigns O
have O
been O
extensively O
reported O
on O
by O
a O
range O
of O
groups O
, O
including O
Kaspersky O
, O
FireEye O
, O
Citizen O
Lab O
, O
the O
Electronic O
Frontier O
Foundation O
, O
and O
many O
others O
. O

These O
attacks O
have O
become O
increasingly O
sophisticated O
, O
although O
the O
capabilities O
and O
tactics O
used O
by O
these O
threat O
actors O
vary O
considerably O
. O

We O
must O
stress O
that O
although O
these O
claims O
have O
not O
been O
corroborated O
, O
South O
Korea O
has O
taken O
the O
regime O
's O
cyber O
threats O
very O
seriously O
and O
is O
reportedly O
training O
5000 O
personnel O
to O
defend O
against O
North O
Korean O
cyber O
attacks O
. O

While O
these O
smaller O
sites O
make O
up O
only O
a O
small O
portion O
of O
the O
grid O
, O
new O
decentralized O
power O
input O
feeds O
are O
a O
challenge O
for O
the O
balance O
of O
the O
power O
grid O
as O
well O
and O
need O
to O
be O
carefully O
monitored O
. O

Operational O
capabilities O
refer O
to O
the O
potential O
use O
of O
these O
capabilities O
. O

• O
APT28 O
malware O
, O
in O
particular O
the O
family O
of O
modular O
backdoors O
that O
we O
call O
CHOPSTICK O
, O
indicates O
a O
formal O
code O
development O
environment O
. O

In O
order O
to O
test O
Snake O
's O
communications O
with O
the O
C O
& O
C O
servers O
, O
and O
still O
being O
able O
to O
clearly O
distinguish O
its O
traffic O
, O
a O
small O
tool O
was O
built O
to O
generate O
GET O
request O
to O
a O
web O
server O
running O
on O
the O
analysed O
system O
. O

Recipients O
may O
only O
share O
TLP O
: O
AMBER O
information O
with O
members O
of O
their O
own O
organisation O
who O
need O
to O
know O
, O
and O
only O
as O
widely O
as O
necessary O
to O
act O
on O
that O
information O
. O

This B-Entity
driver I-Entity
attempts O
to O
hide B-Action
a B-Entity
wide I-Entity
swath I-Entity
of I-Entity
TCP I-Entity
ports I-Entity
( I-Entity
40000-45000 I-Entity
) I-Entity
for B-Modifier
an B-Entity
unknown I-Entity
reason I-Entity
, O
however O
it O
is O
suspected O
that O
this O
may O
relate O
to O
the O
potential O
network O
relaying O
capability O
alluded O
to O
for O
the O
backdoor O
dll O
. O

For O
the O
past O
several O
weeks O
we O
have O
taken O
a O
closer O
look O
at O
a O
great O
number O
of O
detections O
of O
this O
malware O
in O
many O
unrelated O
incidents O
. O

Korea O
Computer O
Center O
( O
KCC O
) O
is O
North O
Korea O
's O
leading O
government O
research O
center O
for O
information O
technology O
. O

Both O
attacks O
use O
a O
.doc O

As O
such O
it O
is O
necessary O
to O
describe O
each O
in O
the O
context O
of O
its O
specific O
sub-family O
. O

Every O
binary O
created O
using O
the O
Microsoft O
Visual O
Studio O
toolchain O
has O
a O
special O
header O
that O
contains O
information O
about O
the O
number O
of O
input O
object O
files O
and O
version O
information O
of O
the O
compilers O
used O
to O
create O
them O
, O
the O
'' O
Rich O
'' O
header O
called O
so O
by O
the O
magic O
string O
that O
is O
used O
to O
identify O
it O
in O
the O
file O
. O

Qamar O
indicated O
on O
his O
public O
LinkedIn O
profile O
that O
he O
'' O
engaged O
in O
system O
and O
enterprise O
level O
network O
and O
Web O
application O
security O
testing O
for O
clients O
ranging O
from O
large O
federal O
agencies O
, O
DoD O
, O
and O
commercial O
clients O
'' O
, O
though O
it O
is O
unclear O
which O
'' O
DoD O
'' O
is O
referenced O
( O
e.g. O
, O
whether O
the O
Pakistani O
Ministry O
of O
Defense O
or O
some O
other O
nation O
's O
defense O
department O
) O
. O

Note O
that O
javaplug-in O
[ O
. O

The O
ecosystem O
surrounding O
the O
SOURFACE O
downloader O
frequently O
consists O
of O
a B-Entity
dropper I-Entity
, O
which O
installs B-Action
SOURFACE B-Entity
. O

You O
may O
recall O
that O
dll B-Entity
[ I-Entity
. I-Entity
] I-Entity
freshdns I-Entity
[ I-Entity
. I-Entity
] I-Entity
org I-Entity
, I-Entity
ali I-Entity
[ I-Entity
. I-Entity
] I-Entity
blankchair I-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
and I-Entity
cht I-Entity
[ I-Entity
. I-Entity
] I-Entity
blankchair I-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
were B-Action
all I-Action
linked I-Action
to B-Modifier
both B-Entity
Operation I-Entity
DeputyDog I-Entity
and I-Entity
Operation I-Entity
Ephemeral I-Entity
Hydra I-Entity
. O

The O
attacks O
are O
still O
ongoing O
as O
of O
July O
2014 O
, O
actively O
targeting O
users O
in O
Europe O
and O
the O
Middle O
East O
. O

This O
move O
placed O
all O
three O
countries O
more O
firmly O
in O
the O
EU O
's O
political O
, O
economic O
, O
and O
security O
spheres O
of O
influence O
. O

This O
can O
either O
be O
proprietary O
systems O
, O
such O
as O
the O
case O
of O
Trojan.Jokra O
in O
South O
Korea O
, O
or O
OS-specific O
, O
such O
as O
hijacking O
Windows O
Update O
, O
in O
the O
case O
of O
Flamer O
. O

This B-Entity
dropper I-Entity
impersonated B-Action
a B-Entity
tool I-Entity
to I-Entity
submit I-Entity
a I-Entity
résumé I-Entity
to I-Entity
Teledyne I-Entity
. O

This O
machine O
is O
most O
likely O
used O
to O
track O
which O
compromised O
routers O
are O
currently O
available O
for O
use O
. O

The B-Entity
associated I-Entity
Darkhotel I-Entity
backdoor I-Entity
was B-Action
hosted I-Action
on B-Modifier
bittorrent B-Entity
, I-Entity
emule I-Entity
, I-Entity
etc I-Entity
, I-Entity
under B-Modifier
a B-Entity
variety I-Entity
of I-Entity
comic I-Entity
names I-Entity
. O

Targets O
may O
be O
tricked O
into O
visiting O
spoofed O
versions O
of O
well- O
known O
websites O
and O
the B-Entity
threat I-Entity
may O
be B-Action
installed I-Action
through B-Modifier
a B-Entity
web I-Entity
browser I-Entity
or O
by B-Modifier
exploiting B-Entity
an I-Entity
application I-Entity
. O

Most B-Entity
interaction I-Entity
between I-Entity
attackers I-Entity
and I-Entity
their I-Entity
infrastructure I-Entity
is B-Action
performed I-Action
via B-Modifier
a B-Entity
convoluted I-Entity
network I-Entity
of I-Entity
router I-Entity
proxies I-Entity
and I-Entity
rented I-Entity
hosts I-Entity
. O

The O
following O
is O
a O
list O
of O
the O
Indicators O
of O
Compromise O
( O
IOCs O
) O
that O
can O
be O
added O
to O
network O
security O
solutions O
to O
determine O
whether O
they O
are O
present O
on O
a O
network O
. O

The O
main O
purpose O
of O
the B-Entity
module I-Entity
is O
to O
collect B-Action
various B-Entity
secrets I-Entity
stored I-Entity
on I-Entity
a I-Entity
lo- I-Entity
cal I-Entity
system I-Entity
and O
upload B-Action
them B-Entity
to B-Modifier
Darkhotel B-Entity
command I-Entity
and I-Entity
control I-Entity
servers I-Entity
: O
This B-Entity
module I-Entity
is O
designed O
to O
terminate B-Action
itself B-Entity
on B-Modifier
Windows B-Entity
with I-Entity
the I-Entity
system I-Entity
de- I-Entity
fault I-Entity
codepage I-Entity
set I-Entity
to I-Entity
Korean I-Entity
. O

This O
component O
consists O
of O
a O
service O
orchestrator O
working O
in O
Windows O
' O
kernel O
. O

It O
runs O
a O
control O
panel O
which O
is O
password O
protected O
: O
Once O
logged O
into O
the O
Control O
panel O
, O
the O
attackers O
can O
see O
a O
general O
overview O
of O
the O
system O
including O
the O
number O
of O
interesting O
potential O
targets O
: O
A O
very O
interesting O
file O
on O
the O
servers O
is O
task.css O
, O
where O
the B-Entity
attackers I-Entity
define B-Action
the B-Entity
IP I-Entity
ranges I-Entity
they I-Entity
are I-Entity
interested I-Entity
in I-Entity
. O

The O
attribution O
indicators O
point O
in O
different O
directions O
and O
ca O
n't O
be O
given O
much O
weight O
. O

A O
random O
seed O
is O
the O
initial O
value O
passed O
into O
a O
pseudo-randomizer O
function O
. O

The O
United O
Front O
Department O
( O
UFD O
) O
conducts O
overt O
operations O
to O
create O
pro-North O
Korean O
groups O
in O
South O
Korea O
. O

All O
Internet O
Service O
Providers O
( O
ISPs O
) O
in O
Iran O
are O
required O
to O
implement O
filtering O
technology O
that O
censors O
access O
to O
content O
which O
the O
Iranian O
government O
deems O
unacceptable O
. O

This O
specific O
variant O
shows O
similarities O
to O
that O
used O
during O
the O
VOHO O
campaign O
, O
where O
Gh0st B-Entity
RAT I-Entity
was B-Action
spread I-Action
via B-Modifier
watering B-Entity
hole I-Entity
attacks I-Entity
utilising I-Entity
vulnerable I-Entity
websites I-Entity
belonging I-Entity
to I-Entity
financial I-Entity
services I-Entity
and I-Entity
technology I-Entity
companies I-Entity
. O

Sources O
may O
use O
TLP O
: O
AMBER O
when O
information O
requires O
support O
to O
be O
effectively O
acted O
upon O
, O
but O
carries O
risks O
to O
privacy O
, O
reputation O
, O
or O
operations O
if O
shared O
outside O
of O
the O
organisations O
involved O
. O

This O
SYS O
file O
is O
a O
also O
a O
commercially O
available O
tool O
that O
allows O
read/write O
access O
to O
files O
and O
raw O
disk O
sectors O
for O
user O
mode O
applications O
in O
Windows O
2000 O
, O
XP O
, O
2003 O
, O
Vista O
, O
2008 O
( O
64-bit O
) O
. O

We O
found O
a O
file O
that O
VirusTotal O
had O
downloaded O
from O
faddeha.com O
, O
which O
appeared O
to O
be O
a O
re- O
mote O
access O
toolkit O
known O
as O
SpyNet O
, O
available O
for O
general O
pur- O
chase O
for O
50 O
Euros O
. O

The O
message O
was O
received O
on O
12/8/12 O
on O
a O
Facebook O
account O
linked O
to O
the O
Twitter O
handle O
, O
and O
contained O
a O
link O
to O
a O
protest O
video O
, O
purport- O
edly O
sent O
by O
an O
anti-government O
individual O
. O

In O
response O
, O
the O
Chinese O
government O
stated O
that O
the O
claims O
were O
'' O
absurd O
'' O
and O
based O
on O
'' O
fabricated O
facts O
'' O
. O

When O
one O
is O
found O
, O
it O
replaces O
'' O
.xhtml O

On O
2nd O
January O
2014 O
a O
Systems O
Administrator O
at O
the O
Monju O
fast O
breeder O
reactor O
facility O
in O
Japan O
noticed O
suspicious O
connections O
emanating O
from O
a O
machine O
in O
the O
control O
room O
, O
coinciding O
with O
what O
was O
a O
seemingly O
routine O
software O
update O
to O
a O
free O
media O
player O
. O

We O
hope O
this O
paper O
kickstarts O
the O
conversation O
on O
how O
to O
better O
protect O
the O
security O
and O
privacy O
in O
third-party O
libraries O
and O
how O
to O
further O
harden O
the O
Android O
security O
framework O
in O
the O
future O
. O

This B-Entity
kernel I-Entity
mode I-Entity
rootkit I-Entity
implements B-Action
several B-Entity
hooking I-Entity
techniques I-Entity
that O
are O
aimed O
at O
preventing B-Action
a B-Entity
system I-Entity
administrator I-Entity
from B-Modifier
detecting B-Entity
the I-Entity
backdoor I-Entity
DLL I-Entity
. O

The O
specific O
malware O
used O
in O
the O
attacks O
has O
never O
been O
disclosed O
, O
however O
. O

This O
whitepaper O
aims O
to O
expose O
the O
view O
we O
have O
on O
the O
group O
, O
especially O
on O
their O
infrastructure O
and O
capabilities O
. O

The B-Entity
network I-Entity
stack I-Entity
hooking I-Entity
first O
queries B-Action
the B-Entity
OS I-Entity
version I-Entity
using B-Modifier
RtlGetVersion B-Entity
( I-Entity
) I-Entity
or I-Entity
PsGetVersion I-Entity
( I-Entity
) I-Entity
. O

At O
this O
stage O
, O
the O
APT O
attackers O
have O
a O
solid O
knowledge O
of O
their O
target O
and O
its O
key O
employees O
. O

The O
cyber-espionage O
operation O
behind O
the O
Snake O
rootkit O
is O
well O
established O
, O
a O
sample O
comiled O
in O
January O
2006 O
indicates O
that O
the O
activity O
would O
have O
begun O
in O
at O
least O
2005 O
. O

Our O
investigation O
found O
that O
malware-laden B-Entity
versions I-Entity
of I-Entity
legitimate I-Entity
anti-censorship I-Entity
software I-Entity
, I-Entity
such I-Entity
as I-Entity
Psiphon I-Entity
and I-Entity
Ultrasurf I-Entity
, O
were B-Action
distributed I-Action
to B-Modifier
users B-Entity
Iran I-Entity
and I-Entity
Persian I-Entity
speaking I-Entity
people I-Entity
around I-Entity
the I-Entity
world I-Entity
. O

However O
, O
the O
two O
malware O
types O
both O
use O
the O
same O
packer O
'Jokra O
' O
and O
both O
contain O
the O
strings O
'' O
HASTATI O
'' O
and O
'' O
PRINCPES O
'' O
. O

This O
analysis O
illustrates O
Regin O
's O
architecture O
and O
the O
many O
payloads O
at O
its O
disposal O
. O

Since O
Operation O
Clandestine O
Fox O
, O
we O
have O
observed O
this O
actor O
execute O
multiple O
attacks O
that O
did O
not O
rely O
on O
zero-day O
exploits O
. O

. O

The B-Entity
attackers I-Entity
set O
up O
the O
environment O
and O
hit B-Action
their B-Entity
individual I-Entity
targets I-Entity
with B-Modifier
precision B-Entity
. O

When O
command O
0x23000004 O
is O
received O
, O
a B-Entity
temporary I-Entity
new I-Entity
user I-Entity
'' I-Entity
DomainUser I-Entity
'' I-Entity
with I-Entity
password I-Entity
'' I-Entity
Dom4 I-Entity
! I-Entity
nU- I-Entity
serP4ss I-Entity
'' I-Entity
is B-Action
created I-Action
and O
added B-Action
to B-Modifier
the B-Entity
local I-Entity
Administrators I-Entity
group I-Entity
. O

He O
is O
best O
known O
for O
his O
avid O
botnet O
research O
( O
often O
going O
by O
'' O
botnethunter O
'' O
) O
and O
for O
his O
novel O
malware O
analysis O
in O
the O
A O
Study O
in O
Bots O
blog O
series O
hosted O
by O
Cylance O
. O

Known O
DPRK O
targets O
have O
been O
limited O
primarily O
to O
South O
Korean O
and O
U.S. O
organizations O
and O
government O
entities O
. O

For O
example O
, O
in O
January O
2013 O
a O
group O
claiming O
to O
be O
related O
to O
Anonymous O
posted O
access O
details O
for O
what O
they O
said O
were O
Israeli O
SCADA O
systems O
for O
power O
plants O
and O
other O
systems O
. O

Developed O
by O
Symantec O
Research O
Labs O
, O
TRIAGE O
is O
data O
mining O
software O
that O
relies O
on O
multi-criteria O
decision O
analysis O
and O
intelligent O
data O
fusion O
algorithms O
to O
reliably O
link O
different O
attacks O
to O
the O
same O
source O
. O

Pipe O
server O
is O
a O
special O
mode O
of O
the O
injected O
DLL O
. O

It O
showed O
, O
that O
the O
functionality O
is O
obfuscated O
in O
some O
way O
, O
e.g O
. O

We O
named O
this O
position O
'Chen O
' O
, O
in O
relation O
with O
several O
references O
of O
this O
common O
Chinese O
name O
in O
c O
& O
c O
WHOIS O
and O
other O
investigation O
materials O
. O

This B-Entity
command I-Entity
then O
modifies B-Action
the B-Entity
creation I-Entity
, I-Entity
modification I-Entity
, I-Entity
and I-Entity
last I-Entity
access I-Entity
timestamps I-Entity
of I-Entity
the I-Entity
modified I-Entity
file I-Entity
to B-Modifier
conceal B-Entity
the I-Entity
content I-Entity
modifications I-Entity
. O

The O
Citizen O
Lab O
analyzed O
this O
attack O
with O
the O
consent O
of O
RSS O
, O
which O
requested O
that O
their O
name O
be O
used O
in O
this O
report O
. O

Despite O
the O
different O
models O
, O
both B-Entity
variants I-Entity
of I-Entity
the I-Entity
Loader I-Entity
load B-Action
the B-Entity
embedded I-Entity
DLL I-Entity
in B-Modifier
the B-Entity
exact I-Entity
same I-Entity
way I-Entity
. O

Recruiting O
hackers O
through O
this O
model O
allows O
Iran O
to O
influence O
their O
activities O
, O
and O
provides O
the O
Iranian O
government O
plausible O
deniability O
, O
but O
a O
lack O
of O
direct O
control O
also O
means O
that O
the O
groups O
may O
be O
unpredictable O
and O
engage O
in O
unsanctioned O
attacks O
. O

'' O
A O
spokesman O
for O
Belgacom O
declined O
to O
comment O
specifically O
about O
the O
Regin O
revelations O
, O
but O
said O
that O
the O
company O
had O
shared O
'' O
every O
element O
about O
the O
attack O
'' O
with O
a O
federal O
prosecutor O
in O
Belgium O
who O
is O
conducting O
a O
criminal O
investigation O
into O
the O
intrusion O
. O

There O
are O
several O
pieces O
of O
evidence O
to O
indicate O
that O
the O
activity O
tracked O
by O
CrowdStrike O
as O
PUTTER O
PANDA O
is O
attributable O
to O
a O
set O
of O
actors O
based O
in O
China O
, O
operating O
on O
behalf O
of O
the O
Chinese O
People O
's O
Liberation O
Army O
( O
PLA O
) O
. O

Overall O
, O
victims O
in O
our O
sinkhole O
logs O
and O
KSN O
data O
were O
found O
across O
the O
globe O
, O
with O
the O
majority O
in O
Japan O
, O
Taiwan O
, O
China O
, O
Russia O
, O
Korea O
and O
Hong O
Kong O
. O

Analyzing O
network O
traffic O
between O
our O
infected O
VM O
and O
the O
C O
& O
C O
server O
revealed O
that O
the O
server O
used O
a O
global O
IPID O
, O
which O
allowed O
us O
to O
infer O
server O
activity O
by O
its O
progression O
. O

North O
Korea O
has O
a O
long O
history O
of O
ties O
to O
Russia O
. O

This O
modular O
approach O
has O
been O
seen O
in O
other O
sophisticated O
malware O
families O
such O
as O
Flamer O
and O
Weevil O
( O
The O
Mask O
) O
, O
while O
the O
multi-stage O
loading O
architecture O
is O
similar O
to O
that O
seen O
in O
the O
Duqu/Stuxnet O
family O
of O
threats O
. O

It O
is O
likely O
that O
the O
attackers O
would O
redeploy O
their O
implant O
against O
other O
targets O
, O
albeit O
with O
a O
delivery O
mechanism O
more O
tailored O
to O
the O
location O
of O
the O
intended O
victims O
. O

The O
2 O
f O
variables O
probably O
had O
different O
names O
in O
the O
original O
script O
which O
avoided O
the O
issue O
. O

domains O
seem O
to O
be O
given O
away O
for O
free O
. O

Upon O
initial O
connection O
, O
the B-Entity
victim I-Entity
sends B-Action
the B-Entity
string I-Entity
, I-Entity
'' I-Entity
HTTP/1.1 I-Entity
GET I-Entity
/dns I-Entity
? I-Entity
\x00 I-Entity
. I-Entity
'' I-Entity
The B-Entity
controller I-Entity
then O
responds B-Action
with B-Modifier
the B-Entity
string I-Entity
'' I-Entity
200 I-Entity
www.yahoo.com I-Entity
! I-Entity
\x00 I-Entity
'' I-Entity
( I-Entity
for I-Entity
'' I-Entity
sensvc.exe I-Entity
'' I-Entity
and I-Entity
'' I-Entity
msensvc.exe I-Entity
'' I-Entity
) I-Entity
or O
with B-Modifier
the B-Entity
string I-Entity
'' I-Entity
RESPONSE I-Entity
200 I-Entity
OK I-Entity
! I-Entity
! I-Entity
'' I-Entity
( I-Entity
for I-Entity
'' I-Entity
netcfg.dll I-Entity
'' I-Entity
) I-Entity
. O

Antivirus O
solution O
with O
proactive O
detection O
methods O
like O
behavioral O
analysis O
and O
reputation O
scanning O
can O
prevent O
unknown O
malware O
from O
installing O
itself O
. O

This O
shows O
that O
the O
attackers O
– O
at O
least O
in O
2013 O
– O
were O
aware O
of O
some O
operational O
security O
considerations O
and O
were O
likely O
taking O
deliberate O
steps O
to O
hide O
their O
origins O
. O

Version O
checking O
is O
important O
in O
all O
Gen O
1 O
variants O
. O

This B-Entity
command I-Entity
runs O
at O
00:29 O
in O
the O
morning O
, O
and O
is B-Action
killed I-Action
by O
taskkill B-Entity
at B-Modifier
00:35 B-Entity
. O

The B-Entity
RAT I-Entity
will O
then O
use B-Action
a B-Entity
byte-wise I-Entity
subtraction- I-Entity
based I-Entity
algorithm I-Entity
( I-Entity
using I-Entity
a I-Entity
hard-coded I-Entity
modulo I-Entity
value I-Entity
) I-Entity
to B-Modifier
decode B-Entity
C2 I-Entity
server I-Entity
details I-Entity
consisting I-Entity
of I-Entity
a I-Entity
server I-Entity
hostname I-Entity
and I-Entity
port I-Entity
number I-Entity
, I-Entity
in I-Entity
this I-Entity
example I-Entity
nsc.adomhn I-Entity
. I-Entity
com I-Entity
, I-Entity
port I-Entity
80 I-Entity
. O

The O
detection O
and O
mitigation O
guidance O
given O
in O
this O
report O
will O
help O
to O
minimize O
the O
risk O
of O
a O
successful O
compromise O
by O
these O
actors O
, O
and O
future O
CrowdStrike O
reports O
will O
examine O
other O
elements O
of O
the O
PUTTER O
PANDA O
toolset O
. O

These O
attacks O
can O
include O
nonspecific O
data O
breaches O
where O
employee B-Entity
or I-Entity
customer I-Entity
records I-Entity
get O
stolen B-Action
, O
as O
happened O
to O
the O
US O
Department O
of O
Energy O
in O
July O
2013 O
. O

'' O
( O
two O
dots O
followed O
by O
a O
space O
then O
two O
more O
dots O
) O
. O

This O
id O
consists O
of O
the O
infected O
computer O
name O
followed O
by O
a O
dash O
and O
the O
lower O
word O
of O
the O
disk O
serial O
id O
. O

Other O
useful O
visualisations O
of O
the O
operations O
come O
from O
the O
compile O
timestamps O
. O

Thus O
random O
seeds O
, O
and O
ultimately O
the O
InitVectors O
, O
are O
functions O
of O
these O
quite O
coarse O
units O
of O
time O
. O

The O
'MZ O
' O
header O
which O
denotes O
a O
binary O
executable O
file O
of O
the O
dropped O
DLL O
is O
initially O
obfuscated O
. O

Analytics O
for O
the O
link O
indicate O
that O
it O
had O
been O
clicked O
once O
from O
inside O
Bahrain O
. O

These B-Entity
families I-Entity
encode B-Action
their B-Entity
strings I-Entity
at B-Modifier
compile B-Entity
time I-Entity
using B-Modifier
a B-Entity
custom I-Entity
stream I-Entity
cipher I-Entity
. O

Data B-Entity
uploaded I-Entity
is B-Action
often I-Action
compressed I-Action
, O
which O
can O
make B-Action
it B-Entity
more B-Entity
difficult I-Entity
to I-Entity
detect I-Entity
the I-Entity
exfiltration I-Entity
of I-Entity
sensitive I-Entity
information I-Entity
. O

Email B-Entity
sent B-Action
through B-Modifier
a B-Entity
specified I-Entity
mail I-Entity
server I-Entity
. O

The O
Windows O
API O
for O
creating O
events O
( O
ZwCreateEvent O
( O
) O
, O
or O
CreateEvent O
( O
) O
in O
user O
mode O
) O
already O
provides O
the O
ability O
to O
'' O
create-or-open O
'' O
an O
event O
, O
so O
the O
use O
of O
an O
initial O
ZwOpenEvent O
is O
superfluous O
and O
indicative O
of O
relatively O
limited O
Windows O
API O
knowledge O
of O
the O
author O
of O
that O
part O
of O
the O
code O
. O

One O
approach O
is O
to O
delegate B-Action
the B-Entity
network I-Entity
communication I-Entity
engine I-Entity
to B-Modifier
usermode B-Entity
code I-Entity
, O
backed O
up O
by O
a O
usermode O
rootkit O
. O

Additionally O
, O
once O
the O
resource O
is O
established O
, O
the B-Entity
malware I-Entity
can O
transfer B-Action
files B-Entity
to B-Modifier
and O
from B-Modifier
the B-Entity
command I-Entity
and I-Entity
control I-Entity
servers I-Entity
using B-Modifier
standard B-Entity
file I-Entity
IO I-Entity
commands I-Entity
. O

The B-Entity
dropped I-Entity
executable I-Entity
( I-Entity
MD5 I-Entity
hash I-Entity
38a2a6782e1af29ca8cb691cf0d29a0d I-Entity
) I-Entity
primarily O
aims O
to O
inject B-Action
the B-Entity
specified I-Entity
DLL I-Entity
( I-Entity
McUpdate.dll I-Entity
, I-Entity
MD5 I-Entity
hash I-Entity
08c7b5501df060ccfc3aa5c8c41b452f I-Entity
) I-Entity
into B-Modifier
a B-Entity
process I-Entity
that I-Entity
would I-Entity
normally I-Entity
be I-Entity
accessing I-Entity
the I-Entity
network I-Entity
, O
likely O
in O
order O
to O
disguise B-Action
the B-Entity
malicious I-Entity
activity I-Entity
. O

[ O
1 O
] O
With O
real-time O
bidding O
, O
advertising O
buyers O
bid O
on O
an O
impression O
and O
, O
if O
the O
bid O
is O
won O
, O
the O
buyer O
's O
ad O
is O
instantly O
displayed O
on O
the O
publisher O
's O
site O
. O

The O
Japanese O
Atomic O
Energy O
Agency O
is O
investigating O
further O
. O

'' O
Network O
DDE O
Service O
'' O
) O
and O
assign O
itself O
as O
the O
executable O
for O
the O
service O
. O

] O
flnet O
[ O
. O

This O
actor O
initiated O
their O
most O
recent O
campaign O
on O
November O
19 O
, O
2014 O
targeting O
multiple O
organizations O
. O

Some O
systems O
are O
physically O
connected O
in O
a O
pure O
read-only O
mode O
for O
monitoring O
. O

The O
RC4 O
encryption O
used O
here O
also O
uses O
a O
50- O
byte O
static O
key O
plus O
four-byte O
random O
salt O
value O
. O

Clipboard B-Entity
monitoring I-Entity
code I-Entity
was B-Action
added I-Action
, O
but O
not O
invoked O
. O

, O
.net O

Finally O
, O
FinSpy B-Entity
's I-Entity
wire I-Entity
protocol I-Entity
for I-Entity
C I-Entity
& I-Entity
C I-Entity
commu- I-Entity
nication I-Entity
uses B-Action
the B-Entity
same I-Entity
type I-Entity
of I-Entity
encryption I-Entity
, O
and O
thus O
is O
subject O
to O
the O
same O
brute O
force O
attack O
on O
AES O
keys O
. O

But O
they O
do O
n't O
need O
Stuxnet O
as O
motivation O
to O
want O
to O
hack O
the O
world O
. O

As O
long O
as O
the O
test O
tool O
named O
chrome.exe O
did O
not O
make O
any O
requests O
, O
its O
memory O
stayed O
pristine O
. O

Once O
the O
ability O
to O
execute O
arbitrary O
code O
has O
been O
established O
, O
an O
attacker O
's O
job O
becomes O
quite O
a O
bit O
easier O
. O

'' O
In O
contrast O
, O
normal O
permissions O
are O
automatically O
granted O
at O
installation O
, O
'' O
without O
asking O
for O
the O
user O
's O
explicit O
approval O
( O
though O
the O
user O
always O
has O
the O
option O
to O
review O
these O
permissions O
before O
installing O
) O
'' O
. O

There O
are O
approximately O
25 O
known O
Gen O
2.2 O
DLLs O
with O
the O
26 O
July O
2013 O
compile O
date O
. O

These B-Entity
droppers I-Entity
contained B-Action
icons B-Entity
used I-Entity
in I-Entity
the I-Entity
legitimate I-Entity
installers I-Entity
for I-Entity
these I-Entity
programs I-Entity
. O

Suffice O
to O
say O
, O
the O
hole O
was O
a O
lot O
deeper O
than O
we O
expected O
! O
In O
fact O
, O
it O
went O
all O
the O
way O
back O
to O
the O
notorious O
Russian O
APT O
family O
MiniDuke O
, O
known O
to O
have O
been O
used O
in O
targeted O
attacks O
against O
NATO O
and O
European O
government O
agencies O
. O

If O
the B-Entity
rootkit I-Entity
detects B-Action
that B-Modifier
the B-Entity
OS I-Entity
version I-Entity
is I-Entity
pre-Vista I-Entity
( I-Entity
e.g I-Entity
. I-Entity
Windows I-Entity
XP I-Entity
) I-Entity
or I-Entity
Windows I-Entity
Server I-Entity
2008 I-Entity
( I-Entity
e.g I-Entity
. I-Entity
Windows I-Entity
Server I-Entity
2003 I-Entity
) I-Entity
, O
it B-Entity
will O
invoke B-Action
FwpsStreamInjectAsync0 B-Entity
( I-Entity
) I-Entity
API I-Entity
in O
order O
to O
generate B-Action
outbound B-Entity
requests I-Entity
. O

Seventy O
emails O
were O
sent O
to O
58 O
individuals O
using O
either O
'' O
2012-13 O
NFL O
Playoffs O
Schedule O
'' O
or O
'' O
Re O
: O
2012-13 O
NFL O
Playoffs O
Schedule O
'' O
as O
a O
subject O
line O
. O

Each B-Entity
Gen I-Entity
2 I-Entity
infection I-Entity
can O
support B-Action
up B-Modifier
to I-Modifier
10 B-Entity
listening I-Entity
ports I-Entity
. O

In O
2011 O
, O
South O
Korea O
's O
National O
Intelligence O
Service O
reportedly O
discovered O
the O
presence O
of O
Communist O
spies O
. O

It O
was O
the O
first O
glimpse O
into O
the O
real O
capabillity O
and O
intention O
of O
Iranian O
cyber O
operations O
. O

• O
The B-Entity
commands I-Entity
supported B-Action
by O
the B-Entity
RAT I-Entity
enable O
several O
capabilities O
, O
including O
: O
The O
3PARA O
RAT O
was O
described O
in O
some O
detail O
in O
other O
CrowdStrike O
reporting O
, O
which O
examined O
a O
DLL-based O
sample O
with O
an O
exported O
filename O
of O
ssdpsvc.dll O
. O

Yokogawa O
fired O
the O
leader O
of O
the O
trade O
union O
, O
Sami O
Ab- O
dulaziz O
Hassan O
, O
on O
3/23/13 O
. O

10/27 O
: O
For O
clarification O
, O
Invincea O
has O
added O
additional O
notes O
in O
this O
version O
that O
the O
websites O
shown O
here O
and O
the O
3rd O
party O
real-time O
ad O
networks O
are O
being O
used O
unwittingly O
and O
their O
resources O
misappropriated O
by O
malvertisers O
to O
target O
companies O
for O
persistent O
remote O
access O
, O
click O
fraud O
, O
and O
other O
nefarious O
activities O
. O

Meanwhile O
the O
perpetrators O
are O
able O
to O
use O
traditional O
malvertising O
and O
ad O
fraud O
bots O
to O
fund O
the O
criminal O
enterprise O
. O

Avira B-Entity
antivirus I-Entity
was B-Action
specifically I-Action
targeted I-Action
and I-Action
disabled I-Action
, O
due O
to O
its O
detection O
of O
the B-Entity
new I-Entity
keystroke I-Entity
logger I-Entity
module I-Entity
added B-Action
in B-Modifier
this B-Entity
version I-Entity
. O

The O
attachment O
exploited O
CVE-2010-3333 O
, O
an O
RTF O
pars- O
ing O
vulnerability O
in O
Microsoft O
Office O
. O

• O
Muhammad O
Naseer O
Bhatti O
was O
the O
self-proclaimed O
founder O
of O
Digital O
Linx O
. O

This B-Entity
attack I-Entity
, O
which O
has O
little O
technical O
sophistication O
( O
i.e. O
, O
it O
uses O
no O
exploits O
, O
code O
obfuscation O
, O
or O
techniques O
to O
frustrate O
reversing O
, O
etc O
. O

SmartAssembly B-Entity
was B-Action
reused I-Action
again O
. O

This O
show O
of O
power O
may O
require O
that O
the O
regime O
takes O
chances O
and O
stretches O
beyond O
its O
abilities O
at O
times O
, O
but O
in O
the O
spirit O
of O
juche O
and O
songun O
, O
the O
regime O
will O
continue O
this O
façade O
, O
fearful O
of O
losing O
the O
image O
its O
leaders O
have O
worked O
so O
hard O
to O
maintain O
. O

During O
its O
infection O
routine O
, O
the B-Entity
infector I-Entity
changes B-Action
the B-Entity
entrypoint I-Entity
of I-Entity
executable I-Entity
files I-Entity
, O
creates B-Action
an B-Entity
.rdat I-Entity
section I-Entity
, O
and O
inserts B-Action
a B-Entity
small I-Entity
loader I-Entity
in B-Modifier
the B-Entity
section I-Entity
, O
then O
puts B-Action
its B-Entity
main I-Entity
payload I-Entity
in B-Modifier
the B-Entity
overlay I-Entity
. O

An O
interesting O
thing O
about O
the O
shellcode O
is O
that O
before O
transferring O
control O
to O
any O
API O
function O
it B-Entity
checks O
the O
first O
bytes O
of O
the O
function O
in O
order O
to O
detect B-Action
hooks B-Entity
and I-Entity
debugger I-Entity
breakpoints I-Entity
which I-Entity
may I-Entity
be I-Entity
set I-Entity
by I-Entity
security I-Entity
software I-Entity
and I-Entity
monitoring I-Entity
tools I-Entity
. O

Stages O
3 O
and O
above O
are O
based O
on O
a O
modular O
framework O
of O
code O
modules O
. O

This O
means O
that O
two O
separate O
CHOPSTICK O
backdoors O
may O
contain O
vastly O
different O
functionality O
, O
depending O
on O
which O
modules O
were O
included O
at O
compile O
time O
. O

• O
Tranchulas O
and O
VPNSOC O
were O
in O
direct O
communication O
at O
some O
point O
in O
July-August O
2013 O
. O

This O
actor O
is O
discussed O
in O
the O
next O
section O
. O

The O
applet O
contains O
its O
malicious O
class O
file O
at O
the O
path O
'' O
jre7u61windows/x86/Update.class O
'' O
. O

As O
a O
part O
of O
an O
ongoing O
investigation O
, O
our O
research O
led O
us O
to O
embedded B-Entity
iframes I-Entity
within I-Entity
hotel I-Entity
networks I-Entity
that O
redirected B-Action
individuals B-Entity
' I-Entity
web I-Entity
browsers I-Entity
to B-Modifier
phony B-Entity
install- I-Entity
ers I-Entity
. O

Slight O
variations O
on O
the O
C2 O
URLs O
are O
used O
for O
different O
phases O
of O
the O
C2 O
interaction O
: O
Given O
the O
lack O
of O
a O
persistence O
mechanism O
and O
low O
level O
of O
sophistication O
, O
it O
is O
likely O
that O
httpclient O
– O
like O
pngdowner O
– O
is O
used O
as O
a O
second-stage O
or O
supplementary/backup O
tool O
. O

Targeting O
information O
is O
supplied O
via O
command O
line O
parameters O
. O

During O
the O
development O
phase O
of O
Gen O
2.0 O
Alpha O
, O
development O
of O
the O
Gen O
2.0 O
Alpha O
variants O
changes O
locations O
. O

] O
com O
. O

The O
Darkhotel O
toolset O
consists O
of O
multiple O
components O
that O
have O
been O
slightly O
modified O
over O
time O
. O

( O
3 O
) O
7 O
IP O
addresses O
belonging O
to O
Maroc O
Telecom O
. O

When O
G-Data O
published O
on O
Turla/Uroburos O
back O
in O
February O
, O
several O
questions O
remained O
unanswered O
. O

Visiting O
Hamza O
Qamar O
's O
Google+ O
page O
( O
Figure O
9 O
) O
, O
the O
only O
directly O
connected O
person O
was O
Abunasar O
Khan O
. O

 O
The O
power O
to O
guide O
the O
armed O
forces O
and O
oversee O
defense O
building O
. O

VirtualBox O
driver O
version O
1.6.2 O
was O
released O
in O
June O
2 O
, O
2008 O
. O

This O
technol- O
ogy O
sometimes O
suffers O
from O
what O
strike O
us O
as O
amateurish O
mis- O
takes O
( O
multiple O
serious O
errors O
implementing O
cryptography O
, O
bro- O
ken O
protocol O
messages O
) O
, O
as O
does O
the O
attackers O
' O
employment O
of O
it O
( O
identifying-information O
embedded O
in O
binaries O
, O
C O
& O
C O
servers O
discoverable O
via O
scanning O
or O
'' O
Google O
hacking O
'' O
, O
clusters O
of O
at- O
tack O
accounts O
tied O
by O
common O
activity O
) O
. O

Existing O
security O
technologies O
that O
focus O
solely O
on O
malware O
signatures O
, O
incidators O
of O
compromise O
, O
exploits O
, O
and O
vulnerabilities O
fail O
to O
protect O
against O
the O
majority O
of O
attacks O
as O
they O
are O
blind O
to O
the O
full O
scope O
of O
adversary O
activity O
. O

Interestingly O
enough O
, O
we O
saw O
a O
part O
of O
these O
documents O
appear O
on O
Virus-Total O
, O
with O
an O
additional O
'' O
gift O
'' O
from O
the O
attackers O
, O
a B-Entity
payload I-Entity
dropping B-Action
a B-Entity
malware I-Entity
. O

In O
August O
2012 O
, O
the O
CloudyOmega O
attackers O
exploited O
the O
zero-day O
Adobe O
Flash O
Player O
and O
AIR O
'copyRawDataTo O
( O
) O
' O
Integer O
Overflow O
Vulnerability O
( O
CVE-2012-5054 O
) O
in O
an O
attack O
against O
a O
high-profile O
organization O
in O
Japan O
. O

Consider O
deployment O
of O
a O
coaching O
page O
with O
click O
through O
acceptance O
; O
these O
are O
traditionally O
deployed O
in O
an O
environment O
to O
log O
the O
acceptance O
of O
network O
acceptable O
use O
policy O
or O
to O
notify O
users O
of O
monitoring O
. O

This O
sample O
was O
first O
observed O
during O
a O
drive-by O
attack O
in O
June O
2014 O
, O
and O
was O
downloaded O
from O
java-se O
[ O
. O

If O
the O
string O
IRAN O
is O
in O
the O
response O
, O
the O
text O
is O
displayed O
with O
the O
color O
red O
. O

At O
CrowdStrike O
, O
we O
see O
evidence O
of O
this O
activity O
first-hand O
as O
our O
services O
team O
conducts O
Incident O
Response O
investigations O
and O
responds O
to O
security O
breaches O
at O
some O
of O
the O
largest O
organizations O
around O
the O
world O
. O

In O
general O
any O
topic O
can O
be O
used O
in O
a O
social O
engineering O
attempt O
, O
which O
makes O
it O
even O
harder O
for O
regular O
users O
to O
spot O
the O
attacks O
. O

Figure O
12 O
: O
Squid O
configuration O
file O
showing O
the O
use O
of O
Tarh O
Andishan O
's O
IP O
address O
. O

If O
an O
app O
requests O
both O
dangerous O
permissions O
and O
normal O
permissions O
, O
Android O
only O
displays O
the O
dangerous O
per- O
missions O
by O
default O
. O

Many O
of O
the O
images O
identified O
were O
of O
the O
popular O
Lebanese O
singer O
and O
actress O
Haifa O
Wehbe O
. O

This O
last O
dll O
is O
the O
heart O
of O
the O
threat O
( O
originally O
called O
q5Byo.dll O
in O
this O
instance O
. O

We O
thank O
Kenneth O
Geers O
and O
Jen O
Weedon O
for O
their O
support O
and O
analysis O
on O
these O
findings O
. O

The O
e-mail O
address O
linked O
to O
this O
account O
is O
dyanmips O
@ O
qq.com O
( O
QQ-ID O
: O
2589315828 O
) O
. O

In O
April O
2013 O
, O
based O
on O
compile O
time O
, O
the O
group O
began O
to O
make O
significant O
alterations O
to O
the O
SOURFACE O
downloader O
. O

Suspicious O
responses O
and O
oddly O
similar O
replies O
received O
from O
both O
companies O
to O
our O
inquiries O
, O
as O
well O
as O
anomalies O
in O
their O
email O
headers O
, O
prompted O
us O
to O
research O
the O
companies O
further O
. O

Most O
RTB O
ad O
providers O
allow O
for O
advertisers O
to O
host O
their O
own O
ad O
content O
. O

While O
it O
is O
ambiguous O
as O
to O
which O
timezone O
the O
edits O
actually O
took O
place O
in O
( O
Kazakhstan O
or O
China O
) O
we O
assume O
the O
date O
timestamp O
references O
GMT O
because O
the O
press O
release O
states O
'' O
In O
the O
afternoon O
of O
December O
15 O
local O
time… O
'' O
If O
we O
assume O
the O
photograph O
and O
afternoon O
meeting O
took O
place O
sometime O
prior O
to O
13:43 O
Alma-Ata O
standard O
time O
( O
+0600 O
) O
this O
would O
closely O
correspond O
with O
a O
07:43 O
GMT O
time O
stamp O
. O

After O
approximately O
60 O
seconds O
of O
execution O
time O
, O
CHOPSTICK B-Entity
begins O
communicating B-Action
with B-Modifier
one B-Entity
of I-Entity
its I-Entity
C2 I-Entity
servers I-Entity
over B-Modifier
HTTP B-Entity
. O

This O
particular O
net O
block O
was O
used O
over O
an O
extended O
period O
of O
time O
, O
indicating O
these O
were O
under O
the O
Cleaver O
team's O
physical O
control O
. O

This B-Entity
toolset I-Entity
provides B-Action
a B-Entity
wide I-Entity
degree I-Entity
of I-Entity
control I-Entity
over I-Entity
a I-Entity
victim I-Entity
system I-Entity
and O
can O
provide O
the O
opportunity O
to O
deploy B-Action
additional B-Entity
tools I-Entity
at B-Modifier
will B-Entity
. O

If O
those O
conditions O
are O
satisfied O
it B-Entity
extracts B-Action
the B-Entity
information I-Entity
. O

At O
first O
we O
thought O
these O
IP O
's O
belonged O
to O
some O
commercial O
proxy O
service O
, O
particularly O
since O
several O
such O
proxy O
services O
also O
offer O
IP O
rotation O
. O

The O
TCIRT O
also O
requested O
that O
Mr. O
Khan O
share O
the O
actual O
email O
message O
with O
the O
original O
attached O
headers O
. O

All O
C2 O
transport O
implementations O
contain O
code O
for O
accepting O
and O
handling O
server-side O
connections O
of O
the O
respective O
protocols O
. O

The B-Entity
IIS I-Entity
web I-Entity
server I-Entity
log I-Entity
stealing B-Action
module B-Entity
, O
27E9h B-Entity
, O
is O
an O
example O
of O
a B-Entity
payload I-Entity
module I-Entity
that O
was B-Action
installed I-Action
after B-Modifier
the B-Entity
initial I-Entity
infection I-Entity
and O
was O
specifically O
deployed O
for O
a O
particular O
target O
. O

• O
Sanctions O
against O
North O
Korea O
and O
export O
laws O
prohibit O
the O
sale O
of O
certain O
technologies O
to O
the O
regime O
. O

Notably O
, O
Khan O
included O
a O
screenshot O
of O
an O
email O
message O
. O

• O
Tranchulas O
, O
VPNSOC O
, O
Digital O
Linx O
were O
all O
physically O
located O
in O
Pakistan O
but O
maintained O
virtual O
presence O
within O
the O
U.S. O
• O
Hamza O
Qamar O
was O
an O
employee O
of O
Tranchulas O
. O

It O
is O
unknown O
whether O
North O
Korea O
possesses O
this O
capability O
. O

Those O
records O
are O
formatted O
in O
the O
following O
manner O
: O
Only O
120 O
IP O
addresses O
perform O
the O
'' O
B O
'' O
checkin O
, O
and O
90 O
% O
of O
these O
are O
from O
the O
range O
150.70.97.x O
. O

Actual O
impact O
to O
organizations O
may O
vary O
depending O
on O
the O
type O
and O
number O
of O
systems O
impacted O
. O

It B-Entity
is B-Action
bound I-Action
to B-Modifier
a B-Entity
variety I-Entity
of I-Entity
other I-Entity
software I-Entity
packages I-Entity
that I-Entity
vary I-Entity
in I-Entity
name I-Entity
, O
but O
the O
host O
package O
is O
consistently O
detected O
as O
'' O
Virus.Win32 O
. O

The O
persistence O
mechanism O
discovered O
in O
October O
2014 O
makes O
it O
possible O
to O
intrude O
into O
a O
system O
in O
a O
really O
discreet O
manner O
and O
we O
estimate O
that O
other O
actors O
will O
use O
the O
same O
persistence O
mechanism O
in O
the O
near O
future O
. O

The B-Entity
IP I-Entity
address I-Entity
159.253.144.209 I-Entity
was B-Action
a B-Entity
source I-Entity
for I-Entity
a I-Entity
secondary I-Entity
attacker I-Entity
in I-Entity
various I-Entity
compromises I-Entity
. O

The O
following O
table O
describes O
the O
Stage O
4 O
kernel O
payload O
modules O
and O
Stage O
5 O
user O
mode O
payload O
modules O
, O
which O
we O
have O
seen O
several O
variants O
of O
Regin O
use O
. O

The B-Entity
registry I-Entity
change I-Entity
creates B-Action
the B-Entity
following I-Entity
key I-Entity
: O
Following O
this O
, O
the B-Entity
subroutine I-Entity
will O
set B-Action
the B-Entity
value I-Entity
of I-Entity
the I-Entity
'ServiceDLL I-Entity
' I-Entity
to B-Modifier
the B-Entity
module I-Entity
handle I-Entity
of I-Entity
the I-Entity
DLL I-Entity
. O

In O
one O
example O
, O
the B-Entity
rootkit I-Entity
blocks B-Action
access B-Entity
to I-Entity
registry I-Entity
entries I-Entity
that I-Entity
contain I-Entity
the I-Entity
strings I-Entity
'' I-Entity
Ultra3 I-Entity
'' I-Entity
and I-Entity
'' I-Entity
~ROOT I-Entity
'' I-Entity
. O

Of O
course O
many O
associated O
Iranian O
hacker O
teams O
have O
been O
identified O
in O
public O
and O
private O
security O
circles O
. O

Once O
the O
attackers O
have O
successfully O
managed O
to O
create O
and O
distribute O
their O
own O
package O
, O
they B-Entity
can O
easily O
infect B-Action
all B-Entity
connected I-Entity
systems I-Entity
at B-Modifier
once B-Entity
. O

•C O
CommandCMD O
– O
Execute O
a O
command O
, O
with O
standard O
input/output/error O
redirected O
over O
the O
C2 O
channel O
. O

This B-Entity
backdoor I-Entity
is O
more O
sophisticated O
and O
belongs O
to O
the O
next O
level O
of O
cyber-espionage O
tools O
called B-Action
the B-Entity
'' I-Entity
Carbon I-Entity
system I-Entity
'' I-Entity
or I-Entity
Cobra I-Entity
by O
the B-Entity
Turla I-Entity
attackers I-Entity
. O

Using O
passive O
DNS O
analysis O
, O
we O
see O
the O
domains O
windows.ddns O
[ O
. O

There O
have O
been O
no O
defacements O
since O
December O
2013 O
. O

This O
command O
line O
parameter O
was O
opensesemi O
which O
is O
often O
stored O
in O
the O
application O
's O
code O
in O
an O
obfuscated O
manner O
. O

Neither O
nation O
recognizes O
the O
other O
as O
a O
legitimate O
state O
. O

The B-Entity
first I-Entity
thread I-Entity
sends B-Action
beacons B-Entity
that I-Entity
contain I-Entity
the I-Entity
process I-Entity
listing I-Entity
of I-Entity
the I-Entity
compromised I-Entity
host I-Entity
. O

While O
a O
variety O
of O
Iranian O
hacker O
groups O
had O
engaged O
in O
politically O
motivated O
website O
defacements O
, O
the O
emergence O
of O
the O
'' O
Iranian O
Cyber O
Army O
'' O
in O
2009 O
demonstrated O
'' O
a O
concentrated O
effort O
to O
promote O
the O
Iranian O
government O
's O
political O
narrative O
online O
'' O
. O

The B-Entity
binary I-Entity
we I-Entity
found I-Entity
was B-Action
dropped I-Action
by O
a B-Entity
malicious I-Entity
Word I-Entity
document I-Entity
. O

This O
executable O
, O
( O
sccm.exe O
, O
md5 O
dd8790455109497d49c2fa2442cf16f7 O
) O
is O
a O
classical O
Chinese O
APT O
implant O
. O

In O
any O
case O
, O
although O
much O
is O
still O
shrouded O
in O
mystery O
and O
speculation O
, O
one O
thing O
is O
certain O
. O

The B-Entity
AdobeR1 I-Entity
file I-Entity
writes B-Action
a B-Entity
series I-Entity
of I-Entity
executable I-Entity
files I-Entity
that O
perform B-Action
information B-Entity
collection I-Entity
and O
communication B-Entity
functions O
, O
including O
: O
The B-Entity
program I-Entity
sequence I-Entity
of I-Entity
data I-Entity
collection I-Entity
and I-Entity
sending I-Entity
is B-Action
somewhat B-Entity
unusual I-Entity
, O
with O
each O
program O
performing O
a O
single O
task O
and O
communicating O
via O
markers B-Entity
left B-Action
in B-Modifier
the B-Entity
registry I-Entity
. O

After O
the O
exploit O
or O
script O
executes O
, O
the B-Entity
system I-Entity
downloads B-Action
install.exe B-Entity
, O
which O
has O
the O
following O
metadata O
: O
The B-Entity
file I-Entity
install.exe I-Entity
attempts O
to O
write B-Action
two B-Entity
files I-Entity
( I-Entity
doc.exe I-Entity
and I-Entity
test.exe I-Entity
) I-Entity
to B-Modifier
the B-Entity
hard-coded I-Entity
path I-Entity
'' I-Entity
C I-Entity
: I-Entity
\Users\Public I-Entity
'' I-Entity
, O
which O
fails O
on O
Windows O
XP O
because O
that O
path O
is O
not O
present O
by O
default O
. O

The O
FBI O
issued O
advisories O
about O
similar O
hotel O
incidents O
; O
Australian O
government O
offi- O
cials O
produced O
similar O
, O
newsworthy O
accounts O
when O
they O
were O
infected O
. O

This O
perception O
is O
due O
in O
part O
to O
the O
Russian O
government O
's O
alleged O
involvement O
in O
the O
cyber O
attacks O
accompanying O
its O
invasion O
of O
Georgia O
in O
2008 O
, O
as O
well O
as O
the O
rampant O
speculation O
that O
Moscow O
was O
behind O
a O
major O
U.S. O
Department O
of O
Defense O
network O
compromise O
, O
also O
in O
2008 O
. O

The B-Entity
traffic I-Entity
is B-Action
then I-Action
routed I-Action
through B-Modifier
that B-Entity
host I-Entity
to O
make B-Action
external B-Entity
control I-Entity
and O
data B-Entity
exfiltration I-Entity
still B-Entity
possible I-Entity
. O

Invincea O
has O
shown O
logs O
from O
a O
winning O
malvertising O
bid O
in O
the O
price O
range O
of O
65 O
cents O
per O
impression O
. O

This B-Entity
component I-Entity
then O
encrypts B-Action
and O
writes B-Action
the B-Entity
retrieved I-Entity
values I-Entity
ondisk I-Entity
to B-Modifier
a B-Entity
ran- I-Entity
domly I-Entity
named I-Entity
.tmp I-Entity
, I-Entity
file I-Entity
like I-Entity
ffffz07131101.tmp I-Entity
. O

While O
the O
disclosure O
of O
this O
information O
will O
be O
a O
detriment O
to O
our O
ability O
to O
track O
the O
activity O
of O
this O
group O
, O
it O
will O
allow O
the O
security O
industry O
as O
a O
whole O
to O
defend O
against O
this O
threat O
. O

According O
to O
the O
Wall O
Street O
Journal O
, O
websites B-Entity
belonging I-Entity
to I-Entity
Next I-Entity
Media I-Entity
's I-Entity
Apple I-Entity
Daily I-Entity
publication I-Entity
have O
suffered B-Action
from B-Modifier
an B-Entity
ongoing I-Entity
DDoS I-Entity
attack I-Entity
that I-Entity
'' I-Entity
brought I-Entity
down I-Entity
its I-Entity
email I-Entity
system I-Entity
for I-Entity
hours I-Entity
'' I-Entity
. O

Additional O
research O
into O
Abunasar O
Khan O
identified O
several O
registered O
domains O
and O
fragments O
of O
his O
online O
presence O
. O

The B-Entity
Base64-encoded I-Entity
data I-Entity
still O
contains B-Action
information B-Entity
including I-Entity
the I-Entity
victim I-Entity
's I-Entity
hostname I-Entity
and I-Entity
IP I-Entity
address I-Entity
but O
also O
a O
'' O
mark O
'' O
or O
'' O
campaign O
tag/code O
'' O
that O
the O
threat O
actors O
use O
to O
keep O
track O
of O
their O
various O
attacks O
. O

The O
purpose O
is O
to O
load B-Action
the B-Entity
library I-Entity
into B-Modifier
each B-Entity
and I-Entity
every I-Entity
process I-Entity
executed I-Entity
on I-Entity
the I-Entity
infected I-Entity
system I-Entity
. O

Companies O
can O
monitor O
the O
Internet O
for O
information O
about O
attacks O
in O
the O
same O
vertical O
and O
apply O
lessons O
learned O
where O
possible O
. O

'' O
In O
a O
hacking O
mission O
codenamed O
Operation O
Socialist O
, O
GCHQ B-Entity
gained B-Action
access B-Entity
to I-Entity
Belgacom I-Entity
's I-Entity
internal I-Entity
systems I-Entity
in O
2010 O
by O
targeting O
engineers O
at O
the O
company O
. O

This B-Entity
executable I-Entity
is B-Action
a B-Entity
dropper I-Entity
containing O
a B-Entity
PE I-Entity
resource I-Entity
that O
pretends B-Action
to B-Modifier
be B-Entity
an I-Entity
embedded I-Entity
GIF I-Entity
image I-Entity
file I-Entity
. O

In O
that O
latter O
case O
, O
the B-Entity
sample I-Entity
arrived B-Action
via B-Modifier
e-mail B-Entity
in B-Modifier
a B-Entity
.rar I-Entity
attachment I-Entity
that O
contained O
an B-Entity
.scr I-Entity
file I-Entity
disguised B-Action
as B-Modifier
a B-Entity
Word I-Entity
document I-Entity
. O

The O
ones O
we O
know O
of O
are O
shown O
below O
. O

This O
date O
is O
specified O
in O
the O
dropper O
code O
and O
does O
not O
change O
across O
multiple O
infections O
. O

Nesha B-Entity
often O
utilized B-Action
web-based B-Entity
backdoors I-Entity
developed I-Entity
in I-Entity
ASPX I-Entity
, I-Entity
PHP I-Entity
as I-Entity
well I-Entity
as I-Entity
ColdFusion I-Entity
. O

The O
username O
was O
User-001 O
, O
which O
is O
the O
default O
value O
. O

Upon O
execution O
of O
the O
unload O
routine O
( O
located O
at O
0xFDEFA04A O
) O
, O
the B-Entity
driver I-Entity
performs O
a O
long O
sequence O
of O
steps O
to O
remove B-Action
remaining B-Entity
traces I-Entity
and I-Entity
artifacts I-Entity
. O

CrowdStrike O
's O
report O
also O
briefly O
noted O
the O
use O
of O
an O
update O
server O
vector O
. O

This B-Entity
VBScript I-Entity
drops B-Action
a B-Entity
pair I-Entity
of I-Entity
files I-Entity
on B-Modifier
disk B-Entity
- O
a O
loader O
and O
an O
encrypted O
payload O
. O

While O
there O
are O
several O
variants O
of O
the O
wiper O
, O
all O
seem O
to O
have O
been O
used O
on O
the O
same O
date O
. O

The O
structure O
of O
a O
container O
is O
similar O
to O
the O
FAT O
file O
system O
. O

The B-Entity
malicious I-Entity
payload I-Entity
is B-Action
Backdoor.Emdivi B-Entity
, O
a B-Entity
threat I-Entity
that O
opens B-Action
a B-Entity
back I-Entity
door I-Entity
on B-Modifier
the B-Entity
compromised I-Entity
computer I-Entity
. O

They O
are O
stored O
in O
two O
EVFS O
containers O
as O
files O
: O
• O
% O
System O
% O
\config\SystemAudit.Evt O
: O
Contains O
Stage O
4 O
kernel O
drivers O
, O
which O
constitute O
the O
kernel O
mode O
part O
of O
Regin O
's O
payload O
. O

Other O
campaigns O
look O
like O
they O
were O
planned O
over O
a O
lengthy O
period O
and O
carried O
out O
methodically O
with O
a O
clear O
goal O
in O
mind O
. O

North O
Korea O
's O
electrical O
grid O
can O
not O
support O
a O
large O
technological O
infrastructure O
. O

Although O
we O
have O
found O
it O
on O
a O
c O
& O
c O
server O
of O
the O
group O
, O
there O
is O
no O
evidence O
that O
is O
has O
been O
used O
by O
the O
group O
, O
in O
opposition O
to O
Paladin O
which O
is O
used O
often O
by O
Pitty O
Tiger O
. O

If O
so O
, O
it O
considers O
it O
to O
be O
a O
system O
shutdown O
, O
so O
it B-Entity
unloads B-Action
its B-Entity
usermode I-Entity
DLL I-Entity
and O
deactivates B-Action
its B-Entity
own I-Entity
network I-Entity
drivers I-Entity
, O
just O
like O
it O
does O
when O
its O
ZwShutdownSystem O
( O
) O
hook O
handler O
gets O
invoked O
. O

In O
addition O
, O
RSS O
is O
targeted O
online O
by O
ISIS O
supporters O
with O
harassment O
, O
including O
threats O
to O
the O
physical O
safety O
of O
its O
members O
. O

A O
detailed O
description O
of O
the O
possible O
values O
for O
commands O
is O
in O
Appendix O
D. O
It O
is O
important O
to O
note O
that O
the O
order O
in O
which O
the O
application O
defines O
them O
is O
not O
the O
same O
order O
as O
they O
appear O
to O
be O
coming O
over O
the O
network O
. O

In O
June O
2009 O
, O
North O
Korea O
stated O
that O
it O
was O
'' O
fully O
ready O
for O
any O
form O
of O
high-tech O
war O
. O

Independence O
Day O
. O

One B-Entity
sample I-Entity
is O
typical O
of O
what O
is O
commonly O
referred O
to O
as O
a O
'dropper O
' O
because O
its O
primary O
purpose O
is O
to O
write B-Action
a B-Entity
malicious I-Entity
component I-Entity
to B-Modifier
disk B-Entity
and O
connect O
it O
to O
the O
targeted O
hosts O
operating O
system O
. O

Based O
on O
compilation O
timestamps O
and O
discovery O
dates O
of O
samples O
we O
have O
observed O
, O
we O
believe O
the B-Entity
OnionDuke I-Entity
operators I-Entity
have O
been B-Action
infecting I-Action
downloaded B-Entity
executables I-Entity
at O
least O
since B-Modifier
the B-Entity
end I-Entity
of I-Entity
October I-Entity
2013 I-Entity
. O

The O
multiple O
proxies O
in O
place O
subscribed O
to O
real O
time O
feeds O
of O
known O
bad O
URLs O
. O

We O
have O
prepared O
a O
map O
of O
the O
city O
of O
Raqqah O
, O
in O
addition O
to O
a O
preliminary O
report O
. O

The O
attacks O
coincided O
with O
State O
Department O
negotiations O
with O
North O
Korea O
regarding O
the O
regime O
's O
nuclear O
missile O
tests O
. O

This O
file O
is O
67320 O
lines O
long O
, O
and O
uses O
5610 O
different O
passwords O
for O
each O
of O
12 O
users O
contained O
in O
this O
file O
. O

After O
a O
router O
SOCKSS O
port O
was O
opened O
by O
Unlocker O
, O
this B-Entity
IP I-Entity
would O
connect B-Action
to B-Modifier
the B-Entity
opened I-Entity
port I-Entity
and O
tunnel B-Action
its B-Entity
email I-Entity
traffic I-Entity
through B-Modifier
the B-Entity
router I-Entity
. O

To O
learn O
more O
about O
the O
scourage O
of O
ransomware O
, O
see O
this O
blog O
. O

This O
technique O
is O
uncommon O
in O
malware O
and O
shows O
the O
advanced O
skillset O
of O
the O
Cleaver O
team O
. O

The B-Entity
document I-Entity
used O
the O
same O
exploit O
and O
attempted O
to O
download B-Action
a B-Entity
second I-Entity
stage I-Entity
from B-Modifier
rcs-demo.hackingteam.it B-Entity
, O
which O
was O
unavailable O
at O
the O
time O
of O
testing O
. O

Regin B-Entity
is O
a O
highly-complex O
threat O
which O
has O
been B-Action
used I-Action
for B-Modifier
large-scale B-Entity
data I-Entity
collection I-Entity
or I-Entity
intelligence I-Entity
gathering I-Entity
campaigns I-Entity
. O

Iran O
's O
cyber O
sophistication O
has O
grown O
rapidly O
since O
the O
dawn O
of O
Stuxnet O
and O
they O
have O
used O
hard O
dollars O
combined O
with O
national O
pride O
to O
help O
build O
their O
cyber O
army O
. O

As O
a O
proof-of-concept O
attack O
scenario O
, O
a B-Entity
malicious I-Entity
app I-Entity
with I-Entity
these I-Entity
two I-Entity
permissions I-Entity
can O
query/insert/ B-Action
alter I-Action
the B-Entity
system I-Entity
icon I-Entity
settings I-Entity
and O
modify B-Action
legitimate B-Entity
icons I-Entity
of I-Entity
some I-Entity
security- I-Entity
sensitive I-Entity
apps I-Entity
, I-Entity
such I-Entity
as I-Entity
banking I-Entity
apps I-Entity
, O
to B-Modifier
a B-Entity
phishing I-Entity
website I-Entity
. O

It O
was O
this O
chain O
of O
events O
that O
served O
as O
a O
catalyst O
for O
extra O
scrutiny O
of O
the O
activity O
and O
collaboration O
between O
the O
ThreatConnect O
and O
FireEye O
Labs O
teams O
to O
share O
information O
. O

It O
buffers O
, O
then O
communicates O
logged O
user O
data O
to O
the O
running O
user O
mode O
component O
. O

«Minmei» O
may O
be O
a O
reference O
to O
a O
popular O
Japanese O
anime O
and O
manga O
known O
as O
«The O
Super O
Dimension O
Fortress O
Macross» O
. O

While O
every O
other O
endpoint O
security O
product O
must O
collect O
a O
sample O
, O
analyze O
, O
and O
write O
a O
signature O
to O
detect O
it O
, O
CylancePROTECT O
can O
detect O
malware O
before O
it O
executes O
by O
statically O
analyzing O
features O
found O
in O
the O
binary O
itself O
. O

Cyber O
espionage O
has O
been O
a O
hot O
topic O
through O
the O
last O
years O
. O

KCC O
's O
other O
projects O
have O
included O
a O
proprietary O
search O
engine O
, O
a O
document O
writer O
, O
a O
game O
called O
Jang-Gi O
, O
the O
Kwangmyong O
intranet O
, O
a O
food O
study O
program O
, O
a O
Korean O
input O
method O
editor O
, O
a O
pen-based O
English-Korean O
and O
Korean-English O
translator O
, O
Korean O
voice O
recognition O
software O
, O
a O
video O
conferencing O
system O
, O
a O
distance O
education O
system O
, O
SilverStar O
Paduk O
software O
, O
HMS O
Player O
, O
and O
the O
Samjiyon O
tablet O
. O

The O
quoted O
material O
below O
are O
direct O
quotes O
from O
Real O
Time O
Bidding O
service O
providers O
linked O
. O

For O
example O
: O
The O
policeman O
told O
me O
, O
'' O
Do O
you O
remember O
when O
you O
were O
talking O
to O
your O
friend O
and O
you O
told O
him O
you O
had O
something O
wrong O
[ O
sic O
] O
and O
paid O
a O
lot O
of O
money O
? O
At O
that O
time O
we O
were O
taking O
information O
from O
your O
laptop O
. O

Falcon O
Intelligence O
enables O
organizations O
to O
prioritize O
resources O
by O
determining O
targeted O
versus O
commodity O
attacks O
, O
saving O
time O
and O
focusing O
resources O
on O
critical O
threats O
. O

] O
com O
resolved O
to O
the O
IP O
address O
88.150.227.197 O
, O
which O
also O
hosted O
domains O
registered O
by O
osshom O
@ O
yahoo O
[ O
. O

The B-Entity
attacks I-Entity
started O
in O
late O
2009 O
and O
were O
directed O
at O
finding B-Action
project B-Entity
details I-Entity
and I-Entity
financial I-Entity
information I-Entity
about I-Entity
oil I-Entity
and I-Entity
gas I-Entity
field I-Entity
exploration I-Entity
and I-Entity
bids I-Entity
. O

] O
org O
, O
and O
they O
have O
engaged O
in O
website O
defacements O
under O
the O
group O
name O
'' O
AjaxTM O
'' O
since O
2010 O
. O

Somewhere O
between O
23,000 O
and O
24,000 O
feet O
an O
enormous O
explosion O
ejected O
nine O
passengers O
into O
the O
dark O
void O
over O
the O
Pacific O
Ocean O
. O

Other O
sub-domains O
at O
the O
same O
free O
host O
and O
DNS O
service O
have O
been O
used O
by O
other O
groups O
to O
spread O
malware O
in O
the O
past O
. O

Information O
can O
be O
supplied O
by O
standard O
input O
. O

Registration O
on O
this O
forum O
shows O
that O
cpyy O
had O
an O
interest O
in O
security-related O
programming O
topics O
, O
which O
is O
backed O
up O
by O
the O
postings O
on O
his O
personal O
blog O
and O
CSDN O
account O
. O

] O
org O
domain O
name O
using O
the O
email O
address O
keyvan.ajaxtm O
@ O
gmail O
[ O
. O

Specifically O
, O
an O
actor O
known O
as O
cpyy O
( O
Chen O
Ping O
) O
appears O
to O
have O
been O
involved O
in O
a O
number O
of O
historical O
PUTTER O
PANDA O
campaigns O
, O
during O
which O
time O
he O
was O
likely O
working O
in O
Shanghai O
within O
the O
12th O
Bureau O
, O
3rd O
General O
Staff O
Department O
( O
GSD O
) O
. O

PLink O
is O
one O
of O
the O
many O
utilities O
provided O
in O
the O
PuTTY O
( O
SSH O
) O
suite O
, O
which O
has O
many O
benign O
purposes O
. O

Most B-Entity
of I-Entity
these I-Entity
components I-Entity
do O
n't O
embed O
their O
own O
C O
& O
C O
information O
but O
rather O
communicate B-Action
with B-Modifier
their B-Entity
controllers I-Entity
through B-Modifier
the B-Entity
original I-Entity
backdoor I-Entity
process I-Entity
. O

Reportedly O
, O
the O
customer O
was O
a O
company O
affiliated O
with O
Iran O
's O
Islamic O
Revolutionary O
Guard O
Corps O
. O

So O
, O
the O
attackers O
lay O
in O
wait O
until O
these O
travelers O
arrive O
and O
connect O
to O
the O
Internet O
. O

In O
addition O
to O
collecting B-Action
files B-Entity
, O
the B-Entity
malware I-Entity
attempts O
to O
gather B-Action
saved B-Entity
passwords I-Entity
, O
history B-Entity
of I-Entity
visited I-Entity
URLs I-Entity
, O
account B-Entity
information I-Entity
and O
proxy B-Entity
information I-Entity
from B-Modifier
the B-Entity
following I-Entity
applications I-Entity
: O
The O
C O
& O
C O
domains O
used O
by O
this O
malware O
are O
: O
Some B-Entity
samples I-Entity
of I-Entity
this I-Entity
file I-Entity
stealer I-Entity
detected B-Action
in B-Modifier
these B-Entity
campaigns I-Entity
also O
contain O
the O
signature O
by O
'' O
Nanning O
weiwu O
Technology O
co. O
, O
ltd O
'' O
– O
another O
indicator O
that O
the O
infections O
are O
related O
. O

) O
If O
the O
actor O
has O
user-level O
access O
, O
the O
result O
includes O
specific B-Entity
files I-Entity
being B-Action
deleted I-Action
and O
practically O
irrecoverable O
, O
but O
the O
victim O
machine O
would O
remain O
usable O
. O

In O
addition O
the O
domains O
listed O
in O
the O
Appendices O
and O
in O
the O
Attribution O
section O
, O
the O
generic O
signatures O
below O
can O
be O
used O
to O
detect O
activity O
from O
the O
malware O
described O
in O
this O
report O
. O

It O
is O
likely O
that O
this B-Entity
request I-Entity
functions O
as O
a O
means O
to O
authenticate O
the O
RAT O
to O
the O
C2 O
server O
and O
register B-Action
a B-Entity
new I-Entity
victim I-Entity
machine I-Entity
with B-Modifier
the B-Entity
controller I-Entity
. O

The O
file O
creation O
times O
turned O
out O
to O
be O
hours O
after O
the B-Entity
files I-Entity
themselves I-Entity
were B-Action
uploaded I-Action
to B-Modifier
the B-Entity
WebDAV I-Entity
share I-Entity
. O

In O
a O
June O
2012 O
episode O
of O
Engineering O
and O
Technology O
Magazine O
podcast O
a O
Mohammed O
Nasser O
, O
Penetration O
Tester O
at O
Tranchulas O
was O
interviewed O
. O

The O
capture O
and O
exfiltration O
phases O
are O
not O
always O
present O
. O

The O
two O
new O
executables O
are O
plugins O
- O
quite O
similar O
to O
each O
other O
and O
obviously O
compiled O
on O
the O
same O
setup O
. O

This B-Entity
Poison I-Entity
Ivy I-Entity
variant I-Entity
connected B-Action
to B-Modifier
a B-Entity
CnC I-Entity
server I-Entity
at I-Entity
ids.ns01 I-Entity
[ I-Entity
. I-Entity
] I-Entity
us I-Entity
. O

The B-Entity
attackers I-Entity
were O
also O
very O
careful O
to O
immediately O
delete B-Action
all B-Entity
traces I-Entity
of I-Entity
their I-Entity
tools I-Entity
as B-Modifier
soon I-Modifier
as I-Modifier
an B-Entity
attack I-Entity
was I-Entity
carried I-Entity
out I-Entity
successfully I-Entity
. O

In O
the O
spirit O
of O
juche O
, O
the O
regime O
uses O
disinformation O
to O
'' O
hide O
lapses O
or O
tout O
accomplishments O
that O
may O
have O
never O
been O
achieved O
. O

3 O
. O

According O
to O
South O
Korean O
reports O
, O
the O
media O
outlets O
targeted O
corresponded O
with O
those O
listed O
by O
the O
North O
Korean O
regime O
in O
2012 O
as O
right-wing O
press O
that O
manipulated O
South O
Korea O
's O
public O
opinion O
. O

This O
makes O
it O
more O
difficult O
for O
forensic O
analysts O
to O
find O
any O
useful O
information O
when O
doing O
pool O
scanning O
, O
since O
all O
its O
memory O
allocations O
will O
mix O
with O
many O
generic O
others O
. O

Both O
of O
these O
certificates O
are O
valid O
but O
can O
be O
detected O
and O
blocked O
via O
the O
following O
Yara O
signatures O
: O
These B-Entity
ongoing I-Entity
DDoS I-Entity
attacks I-Entity
and O
previous O
APT O
intrusion O
activity O
both O
target B-Action
the B-Entity
hkgolden I-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
website I-Entity
. O

We O
were O
unable O
to O
obtain O
the O
second O
stage O
or O
the O
ultimate O
pay- O
load O
, O
as O
the O
website O
was O
unavailable O
at O
the O
time O
of O
testing O
. O

Interesting O
part O
is O
that O
the O
module O
randomly O
generates O
the O
key O
and O
stores O
it O
in O
an O
unexpected O
place O
: O
in O
the O
middle O
of O
the O
log O
file O
name O
. O

From O
this O
we O
were O
able O
to O
locate O
an O
advertisement O
in O
the O
Blackhatworld O
forum O
from O
April O
2012 O
posted O
by O
agnosticon O
promoting O
VPSNOC O
and O
identifying O
it O
as O
a O
subdivision O
of O
Digital O
Linx O
Hosting O
( O
Figure O
7 O
) O
. O

North O
Korea O
has O
a O
longstanding O
historical O
relationship O
with O
China O
. O

This O
same O
certificate O
was O
also O
used O
to O
sign O
the O
Java O
applet O
that O
downloaded O
this O
malware O
. O

It O
seems O
that O
taking O
pictures O
and O
recording O
videos O
without O
user O
notification O
is O
impossible O
. O

APT28 O
's O
characteristics-their O
targeting O
, O
malware O
, O
language O
, O
and O
working O
hours-have O
led O
us O
to O
conclude O
that O
we O
are O
tracking O
a O
focused O
, O
long- O
standing O
espionage O
effort O
. O

However O
, O
with O
this O
information O
, O
an B-Entity
attacker I-Entity
can O
precisely O
locate B-Action
the B-Entity
victim I-Entity
and O
acquire B-Action
the B-Entity
device I-Entity
's I-Entity
specifications I-Entity
. O

These O
investigations O
often O
start O
completely O
passively O
without O
any O
direct O
contact O
with O
the O
company O
, O
since O
there O
are O
many O
data O
sources O
publicly O
available O
. O

The O
nicolatesla53 O
account O
was O
created O
in O
July O
2014 O
. O

The O
domain O
ids.ns01 O
[ O
. O

This O
actor O
is O
historically O
known O
for O
leveraging O
zero- O
day O
vulnerabilities O
in O
widespread O
but O
infrequent O
phishing O
campaigns O
. O

We O
have O
been O
lucky O
enough O
to O
get O
the O
controller O
part O
of O
Pitty O
Tiger O
and O
CT O
RAT O
, O
and O
even O
to O
get O
a O
kind O
of O
hybrid O
controller O
made O
for O
CT O
RAT O
but O
also O
supporting O
Pitty O
Tiger O
. O

While O
North O
Korea O
was O
formerly O
on O
the O
U.S. O
list O
of O
state O
sponsors O
of O
terrorism O
, O
it O
was O
removed O
in O
2008 O
. O

Please O
note O
, O
that O
after O
receiving O
< O
DATA O
> O
, O
it B-Entity
is B-Action
XORed I-Action
with B-Modifier
byte B-Entity
value I-Entity
0x55 I-Entity
and O
saved B-Action
to B-Modifier
a B-Entity
disk I-Entity
in B-Modifier
a B-Entity
file I-Entity
named I-Entity
«ctfmon.exe» I-Entity
( O
current O
directory O
is O
used O
) O
. O

This O
sounds O
like O
a O
great O
way O
to O
advertise O
if O
you O
are O
in O
the O
marketing O
industry O
. O

We O
originally O
located O
it O
on O
a B-Entity
staging I-Entity
server I-Entity
being B-Action
utilized I-Action
for B-Modifier
multiple B-Entity
attacks I-Entity
as I-Entity
well I-Entity
as I-Entity
a I-Entity
tool I-Entity
for I-Entity
sharing I-Entity
data I-Entity
between I-Entity
members I-Entity
of I-Entity
the I-Entity
organization I-Entity
's I-Entity
team I-Entity
. O

Distinguishing O
one O
threat O
group O
from O
another O
is O
possible O
with O
enough O
information O
, O
analytical O
experience O
, O
and O
tools O
to O
piece O
it O
all O
together O
. O

Non-Invincea O
users O
can O
attempt O
to O
OptOut O
of O
directed O
targeting O
where O
you O
can O
. O

In O
a O
nutshell O
, O
the O
VirtualBox O
software O
installs O
a O
driver O
called O
VBoxDrv O
. O

It O
was O
n't O
given O
an O
actual O
name O
, O
only O
a O
generic O
one O
. O

An O
example O
is O
the O
BlackEnergy O
Lite O
variant O
( O
also O
known O
as O
BlackEnergy O
3 O
) O
used O
by O
a O
group O
of O
attackers O
( O
that O
was O
then O
given O
the O
name O
Quedagh O
, O
or O
Sandworm O
) O
against O
targets O
in O
Ukraine O
and O
other O
countries O
. O

Dropper O
samples O
consistently O
targeted O
AhnLab O
Policy O
Center O
as O
a O
propagation O
method O
. O

] O
org O
- O
also O
an O
organization O
involved O
in O
defense O
matters O
- O
were B-Action
redirected I-Action
to B-Modifier
an B-Entity
exploit I-Entity
server I-Entity
at I-Entity
159.54.62.92 I-Entity
. O

Once O
decrypted O
, O
the O
message O
looks O
like O
the O
following O
: O
The O
strings O
'' O
V4MGNxZWlvcmhjOG9yZQ O
'' O
and O
'' O
= O
< O
< O
\xee O
'' O
are O
hardcoded O
in O
the O
implant O
. O

Only O
after O
a O
previously O
unseen O
threat O
has O
inflicted O
damage O
can O
the O
rest O
of O
the O
industry O
begin O
to O
detect O
it O
. O

Although O
the B-Entity
network I-Entity
traffic I-Entity
is B-Action
encoded I-Action
with B-Modifier
a B-Entity
custom I-Entity
Base64 I-Entity
alphabet I-Entity
, O
the O
URI O
pattern O
has O
been O
largely O
consistent O
: O
We O
analyzed O
a O
recent O
sample O
that O
appears O
to O
have O
targeted O
entities O
in O
Taiwan O
, O
a O
target O
consistent O
with O
previous O
Ixeshe O
activity O
. O

More B-Entity
sophisticated I-Entity
attackers I-Entity
obfuscate B-Action
the B-Entity
data I-Entity
by B-Modifier
XOR-ing B-Entity
it I-Entity
, I-Entity
encrypting I-Entity
it I-Entity
with I-Entity
proper I-Entity
asymmetric I-Entity
encryption I-Entity
or I-Entity
embedding I-Entity
it I-Entity
into I-Entity
media I-Entity
files I-Entity
using I-Entity
steganography I-Entity
to B-Modifier
hide B-Entity
the I-Entity
data I-Entity
from I-Entity
traffic I-Entity
inspection I-Entity
. O

• O
Employees O
at O
both O
the O
Pakistan-based O
hosting O
provider O
and O
Tranchulas O
appear O
within O
each O
others O
' O
social O
networks O
. O

Some O
of O
the O
known O
social O
media O
platforms O
employed O
by O
the O
regime O
include O
Twitter O
, O
Facebook O
, O
and O
YouTube O
. O

Loading O
the O
page O
greeted O
the O
target O
with O
'' O
Video O
loading O
please O
wait O
. O

The B-Entity
attackers I-Entity
utilize B-Action
compromised B-Entity
embedded I-Entity
devices I-Entity
– I-Entity
typically I-Entity
routers- I-Entity
on I-Entity
the I-Entity
Internet I-Entity
as I-Entity
well I-Entity
as I-Entity
multiple I-Entity
dedicated I-Entity
hosting I-Entity
providers I-Entity
and I-Entity
VPN I-Entity
services I-Entity
to B-Modifier
mask B-Entity
their I-Entity
identity I-Entity
from I-Entity
the I-Entity
cloud I-Entity
storage I-Entity
provider I-Entity
and I-Entity
others I-Entity
. O

RAONASRT O
is O
a O
South O
Korean O
white O
hat O
capture O
the O
flag O
( O
CTF O
) O
team O
, O
whose O
members O
also O
operate O
under O
the O
name O
'' O
WhoIs O
'' O
. O

In O
addition O
to O
those O
tools O
, O
we O
found O
some O
interesting O
scripts O
. O

We O
did O
not O
find O
more O
information O
about O
user O
'' O
Toot O
'' O
, O
yet O
we O
miss O
Chinese O
language O
capabilities O
. O

Beginning O
at O
age O
17 O
, O
North O
Koreans O
are O
eligible O
to O
join O
the O
Reserve O
Military O
Training O
Unit O
. O

Here O
are O
a O
few O
examples O
of O
subject O
lines O
used O
, O
listed O
by O
category O
: O
In O
the O
last O
six O
month O
of O
2012 O
the O
average O
number O
of O
targeted O
attacks O
observed O
per O
day O
was O
87 O
( O
with O
14 O
in O
the O
energy O
sector O
) O
. O

The O
regime O
's O
drones O
are O
complimentary O
to O
its O
intelligence O
program O
and O
are O
primarily O
used O
for O
surveillance O
. O

After O
uploading B-Action
edg6EF885E2.tmp B-Entity
, O
CHOPSTICK B-Entity
continues O
to O
query B-Action
its B-Entity
C2 I-Entity
servers I-Entity
for B-Modifier
commands B-Entity
using B-Modifier
HTTP B-Entity
GET I-Entity
requests I-Entity
. O

In O
one O
of O
the O
analysed O
kernel-centric O
Snake O
samples O
the O
home O
directory O
was O
hard-coded O
as O
% O
windows O
% O
\ O
$ O
NtUninstallQ817473 O
$ O
, O
so O
it B-Entity
blocked B-Action
file B-Entity
read I-Entity
access I-Entity
from I-Entity
that I-Entity
directory I-Entity
. O

One O
difference O
was O
in O
the B-Entity
vectors I-Entity
used O
to O
install B-Action
the B-Entity
spyware I-Entity
. O

'' O
Tarh O
Andishan O
'' O
is O
often O
translated O
as O
'' O
Thinkers O
'' O
, O
'' O
Innovators O
'' O
and O
'' O
Inventors O
'' O
. O

It O
is O
likely O
this O
is O
the O
same O
reason O
a O
/28 O
net O
range O
was O
used O
, O
in O
order O
to O
not O
look O
like O
it O
was O
intended O
to O
only O
allow O
one O
IP O
. O

Depending O
on O
the O
targeted O
location O
, O
physical O
reconnaissance O
and O
eavesdropping O
may O
also O
be O
used O
. O

This B-Entity
exploit I-Entity
, O
in O
turn O
, O
dropped B-Action
the B-Entity
Poison I-Entity
Ivy I-Entity
variant I-Entity
. O

2.0 O
. O

Operation B-Entity
Cleaver I-Entity
uses B-Action
PLink B-Entity
to B-Modifier
forward B-Entity
local I-Entity
RDP I-Entity
ports I-Entity
to I-Entity
remote I-Entity
SSH I-Entity
servers I-Entity
. O

Here O
is O
a O
pie O
chart O
to O
better O
visualize O
the O
proportions O
of O
attack O
activity O
throughout O
the O
world O
. O

These O
companies O
have O
current O
and O
former O
employees O
who O
are O
ICS O
experts O
. O

Interestingly O
, O
though O
, O
the O
documents O
also O
contain O
the O
newer O
CVE-2014-1761 O
exploit O
that O
was O
extensively O
used O
in O
targeted O
attacks O
carried O
out O
by O
a O
number O
other O
malware O
families O
this O
year O
( O
including O
BlackEnergy O
, O
Sednit O
, O
MiniDuke O
, O
and O
others O
) O
. O

The O
passphrase O
and O
salt O
are O
Persian O
language O
words O
. O

The O
purpose O
of O
the O
first O
three O
files O
is O
unknown O
. O

Not O
all O
data O
files O
have O
been O
recovered O
, O
so O
the O
information O
remains O
incomplete O
. O

This O
is O
typically O
seen O
in O
RATs B-Entity
for O
searching B-Action
specific B-Entity
files I-Entity
to O
exfiltrate B-Action
. O

Structurally O
, O
all O
of O
these O
samples O
are O
similar O
in O
that O
they B-Entity
drop B-Action
three B-Entity
files I-Entity
: O
The B-Entity
KernelBot I-Entity
implants I-Entity
receive B-Action
targeting B-Entity
instructions I-Entity
from B-Modifier
C2 B-Entity
servers I-Entity
hard-coded I-Entity
directly I-Entity
into I-Entity
the I-Entity
sample I-Entity
. O

While O
this O
process O
has O
provided O
a O
rich O
set O
of O
artifacts O
to O
analyze O
, O
it O
does O
not O
permit O
us O
to O
claim O
our O
dataset O
is O
representative O
. O

The O
appendix O
released O
with O
this O
paper O
provides O
technical O
indicators O
of O
compromise O
which O
should O
help O
victims O
identify O
the O
malicious O
traffic O
and O
enable O
targets O
to O
protect O
themselves O
better O
against O
attack O
. O

In O
May O
2014 O
, O
evidence O
emerged O
of O
a B-Entity
highly I-Entity
targeted I-Entity
waterhole I-Entity
attack I-Entity
that O
leveraged B-Action
social B-Entity
media I-Entity
, O
dubbed O
Operation O
Newscaster O
, O
which O
was O
uncovered O
by O
iSight O
Partners O
. O

Finally O
, O
the B-Entity
malware I-Entity
will O
delete B-Action
the B-Entity
content I-Entity
saved I-Entity
from I-Entity
the I-Entity
first I-Entity
request I-Entity
, O
and O
exit O
. O

This O
clever O
tactic O
sought O
to O
leverage O
a O
seemingly O
innocent O
game O
as O
a O
force O
multiplier O
in O
order O
to O
amplify O
the O
effects O
of O
a O
DDoS O
attack O
on O
a O
critical O
infrastructure O
target O
. O

This O
model O
makes O
it O
possible O
to O
do O
the O
intrusion O
in O
steps O
, O
with O
verification O
stages O
in O
between O
; O
and O
the O
files O
will O
not O
be O
easily O
found O
on O
affected O
computers O
. O

This O
is O
followed O
by O
the O
incursion O
phase O
of O
breaking B-Action
in I-Action
and I-Action
compromising I-Action
computers B-Entity
. O

The O
proxy O
( O
or O
socks5 O
) O
command O
allows O
an B-Entity
attacker I-Entity
to O
utilize B-Action
a B-Entity
Hikit-infected I-Entity
machine I-Entity
as B-Modifier
a B-Entity
proxy I-Entity
. O

The B-Entity
hooking I-Entity
is B-Action
performed I-Action
by B-Modifier
creating B-Entity
a I-Entity
new I-Entity
completion I-Entity
routine I-Entity
associated I-Entity
with I-Entity
any I-Entity
IRPMJDEVICECONTROL I-Entity
IRP I-Entity
that I-Entity
matches I-Entity
the I-Entity
IOCTL I-Entity
, I-Entity
attaching I-Entity
to I-Entity
the I-Entity
target I-Entity
process I-Entity
, I-Entity
performing I-Entity
several I-Entity
memory I-Entity
copies I-Entity
to I-Entity
hide I-Entity
the I-Entity
entry I-Entity
, I-Entity
and I-Entity
detaching I-Entity
. O

It B-Entity
aborts B-Action
exploitation B-Entity
if B-Modifier
the B-Entity
user I-Entity
is I-Entity
browsing I-Entity
with I-Entity
a I-Entity
different I-Entity
version I-Entity
of I-Entity
IE I-Entity
or I-Entity
has I-Entity
installed I-Entity
Microsoft I-Entity
's I-Entity
Experience I-Entity
Mitigation I-Entity
Toolkit I-Entity
( I-Entity
EMET I-Entity
) I-Entity
. O

All O
three O
domains O
match O
those O
used O
by O
an O
Indian O
cybermercenary O
group O
said O
to O
be O
linked O
to O
Appin O
Security O
Group O
. O

Analysis O
of O
the O
PDB O
strings O
seen O
in O
the O
implants O
indicates O
that O
there O
may O
be O
more O
than O
one O
developer O
working O
on O
the O
source O
code O
for O
the O
Stealer O
builder O
. O

By O
using O
the O
connect O
command O
, O
an O
attacker O
can O
instruct O
the O
externally O
exposed O
Gen O
1 O
DLL O
to O
route O
traffic O
to O
a O
Gen O
1 O
DLL O
that O
is O
behind O
the O
firewall O
, O
effectively O
making O
the O
externally O
exposed O
Gen O
1 O
DLL O
a O
local O
router O
for O
Hikit O
traffic O
. O

Domains O
used O
by O
the O
Pitty O
Tiger O
group O
: O
( O
please O
note O
several O
subdomains O
are O
used O
, O
as O
seen O
in O
the O
report O
) O
In O
May O
2014 O
, O
the O
U.S. O
Department O
of O
Justice O
charged O
five O
Chinese O
nationals O
for O
economic O
espionage O
against O
U.S. O
corporations O
. O

The B-Entity
igfxext.exe I-Entity
component I-Entity
is B-Action
dropped I-Action
to B-Modifier
disk B-Entity
and O
run B-Action
. O

We O
found O
that O
some O
of O
the O
most O
popular O
ad O
libraries O
( O
see O
Table O
3 O
) O
have O
this O
issue O
. O

Each O
of O
these O
connections O
used O
the O
correct O
encryption O
key O
, O
so O
we O
know O
that O
these O
accesses O
came O
from O
the O
attackers O
and O
not O
some O
opportunistic O
third O
party O
. O

When O
they O
replied O
to O
an O
email O
, O
a B-Entity
new I-Entity
ad I-Entity
was O
loaded O
on O
a O
page O
that O
attempted O
to O
exploit B-Action
Java B-Entity
. O

3 O
. O

FireEye O
has O
over O
1,900 O
customers O
across O
more O
than O
60 O
countries O
, O
including O
over O
130 O
of O
the O
Fortune O
500 O
. O

The O
second O
was O
that O
malware O
compile O
times O
from O
2007 O
to O
2014 O
corresponded O
to O
normal O
business O
hours O
in O
the O
UTC O
+ O
4 O
time O
zone O
, O
which O
includes O
major O
Russian O
cities O
such O
as O
Moscow O
and O
St. O
Petersburg O
. O

Users O
and O
administrators O
are O
recommended O
to O
take O
the O
following O
preventive O
measures O
to O
protect O
their O
computer O
networks O
: O
Use O
and O
maintain O
anti-virus O
software O
– O
Anti-virus O
software O
recognizes O
and O
protects O
your O
computer O
against O
most O
known O
viruses O
. O

We O
suspect O
the O
Pitty O
Tiger O
group O
to O
work O
according O
to O
an O
opportunistic O
business O
model O
: O
this O
group O
might O
offer O
its O
services O
to O
third O
parties O
from O
the O
private O
sector O
. O

In O
this O
campaign O
, O
variants B-Entity
of I-Entity
Backdoor.Emdivi I-Entity
are B-Action
persistently I-Action
used I-Action
as B-Modifier
a B-Entity
payload I-Entity
. O

M O
recalled O
click- O
ing O
on O
a O
link O
from O
Red O
Sky O
while O
using O
an O
Internet O
connec- O
tion O
from O
one O
of O
the O
houses O
in O
M O
's O
village O
. O

The O
most O
compelling O
pictures O
, O
however O
, O
are O
found O
in O
the O
宿舍 O
and O
办公室 O
albums O
( O
'' O
dormitory O
'' O
and O
'' O
office O
'' O
) O
. O

And O
then O
, O
the O
ground O
shifted O
again O
. O

Many O
of O
the O
callback O
URLs O
have O
errors O
, O
many O
are O
from O
unwanted O
IP O
ranges O
, O
and O
others O
are O
clearly O
unwanted O
researcher O
sandbox O
system O
callbacks O
. O

While O
we O
are O
not O
conclusively O
attributing O
BITTERBUG O
activity O
to O
Tranchulas O
or O
a O
specific O
Pakistani O
entity O
, O
we O
can O
confidently O
point O
to O
many O
characteristics O
of O
a O
Pakistan-based O
cyber O
exploitation O
effort O
that O
is O
probably O
directed O
against O
Indian O
targets O
or O
those O
who O
are O
involved O
in O
India-Pakistan O
issues O
. O

The O
Darkhotel O
crew O
's O
skillset O
allows O
it O
to O
launch O
interesting O
cryptographical O
at- O
tacks O
, O
for O
instance O
factoring O
512 O
bit O
RSA O
keys O
. O

More O
recent O
activity O
suggests O
that O
the O
group O
has O
stolen O
certificates O
to O
sign O
their O
code O
. O

Khan O
posts O
pictures O
of O
his O
blue O
Baleno O
and O
includes O
another O
phone O
number O
03234764838 O
. O

We O
have O
seen O
this B-Entity
group I-Entity
leverage B-Action
varied B-Entity
social I-Entity
engineering I-Entity
tactics I-Entity
as O
a O
means O
to O
lure B-Action
their B-Entity
targets I-Entity
into B-Modifier
infecting B-Entity
themselves I-Entity
with I-Entity
malware I-Entity
. O

files O
. O

Another O
connection O
between O
the O
cases O
. O

Snort O
signature O
30948 O
may O
detect O
some O
Hikit O
based O
network O
traffic O
for O
only O
Gen O
1.0 O
and O
Gen O
1.1 O
. O

Two O
previous O
vulnerabilities O
in O
the O
RTF O
file O
format O
, O
known O
as O
CVE-2010-3333 O
and O
CVE-2012-0158 O
, O
had O
become O
, O
by O
that O
time O
, O
mainstays O
of O
targeted O
attacks O
, O
so O
we O
tracked O
how O
attackers O
implemented O
this O
new O
exploit O
with O
keen O
interest O
. O

When O
released O
, O
he O
found O
that O
the O
passwords O
for O
his O
Twitter O
, O
Facebook O
, O
and O
e-mail O
accounts O
had O
been O
changed O
, O
and O
did O
not O
know O
how O
to O
recover O
his O
accounts O
. O

Any O
opinions O
, O
findings O
, O
and O
conclusions O
or O
recom- O
mendations O
expressed O
in O
this O
material O
are O
those O
of O
the O
authors O
and O
do O
not O
necessarily O
reflect O
the O
views O
of O
the O
sponsors O
. O

This O
phenomenon O
creates O
an O
arena O
for O
strategic O
propagation O
of O
both O
fact O
and O
fiction O
for O
the O
purposes O
of O
sentiment O
manipulation O
. O

In O
some O
cases O
, O
the O
Visual O
Basic O
project O
bears O
the O
name O
NoWayTech O
, O
which O
appears O
to O
be O
an O
underground O
RunPE O
tool O
, O
while O
others O
are O
named O
SpyVisual O
, O
which O
we O
have O
been O
unable O
to O
trace O
to O
any O
public O
underground O
tools O
, O
and O
thus O
also O
may O
reflect O
customiza- O
tion O
by O
the O
attacker O
. O

framework O
be O
present O
on O
the O
victim O
machine O
. O

➔ O
Putter O
Panda O
is O
a O
cyber O
espionage O
actor O
that O
conducts O
operations O
from O
Shanghai O
, O
China O
, O
likely O
on O
behalf O
of O
the O
Chinese O
People O
's O
Liberation O
Army O
( O
PLA O
) O
3rd O
General O
Staff O
Department O
12th O
Bureau O
Unit O
61486 O
. O

It O
makes O
use O
of O
WinPcap O
and O
is O
developed O
in O
C. O
Compared O
to O
some O
other O
publicly O
available O
ARP O
cache O
poisoning O
utilities O
, O
Jasus O
is O
poorly O
developed O
and O
without O
many O
useful O
features O
. O

It O
will O
help O
to O
analyze O
how O
effective O
the O
reach O
of O
a O
creative O
was O
. O

The B-Entity
driver I-Entity
creates B-Action
virtual B-Entity
file I-Entity
volumes I-Entity
for B-Modifier
encrypted B-Entity
storage I-Entity
of I-Entity
its I-Entity
files I-Entity
and I-Entity
configuration I-Entity
data I-Entity
: O
The B-Entity
volumes I-Entity
are B-Action
mounted I-Action
from B-Modifier
the B-Entity
virtual I-Entity
file I-Entity
systems I-Entity
RawDisk1 I-Entity
and I-Entity
RawDisk2 I-Entity
. O

The O
attack O
appears O
to O
have O
been O
the O
result O
of O
the B-Entity
attackers I-Entity
having O
compromised B-Action
the B-Entity
'GOM I-Entity
Player I-Entity
' I-Entity
update I-Entity
server I-Entity
and O
having O
it B-Entity
act B-Action
as I-Action
a B-Entity
'watering I-Entity
hole I-Entity
' I-Entity
, O
meaning O
that O
machines B-Entity
which I-Entity
access I-Entity
the I-Entity
site I-Entity
are B-Action
delivered I-Action
malware B-Entity
. O

All O
Inception-related O
malware O
is O
written O
using O
Visual O
Studio O
2010 O
. O

Others O
, O
like O
DarkComet O
, O
are O
free O
. O

The B-Entity
later I-Entity
version I-Entity
of I-Entity
the I-Entity
threat I-Entity
focused B-Action
on B-Modifier
the B-Entity
S7-315 I-Entity
PLCs I-Entity
, O
manipulating B-Action
the B-Entity
spinning I-Entity
frequency I-Entity
of I-Entity
the I-Entity
rotating I-Entity
motors I-Entity
. O

The O
Syrian O
conflict O
is O
ongoing O
, O
making O
it O
difficult O
to O
assem- O
ble O
comprehensive O
evidence O
of O
linkages O
between O
government O
actors O
and O
malware O
campaigns O
. O

On O
September O
9 O
, O
2014 O
, O
a O
ZIP O
file O
containing O
TinyZBot O
and O
a O
configuration O
targeting O
a O
major O
US O
university O
with O
its O
AppUsageId O
was O
created O
. O

This O
attack O
reaffirms O
the O
dangers O
posed O
by O
social O
engineering O
attacks O
, O
whether O
they O
deliver O
phishing O
campaigns O
or O
malware O
. O

: O
If O
the O
server O
reply O
contains O
a O
keyword O
«minmei» O
it B-Entity
continues O
sending B-Action
additional B-Entity
in- I-Entity
formation I-Entity
. O

This B-Entity
file I-Entity
serves B-Action
as B-Modifier
a B-Entity
dropper I-Entity
. O

'' O
The O
regime's O
recent O
reaction O
to O
an O
upcoming O
film O
supports O
these O
statements O
. O

Cylance O
's O
flagship O
product O
CylancePROTECT O
has O
been O
adopted O
by O
Fortune O
500 O
companies O
and O
government O
agencies O
across O
the O
globe O
. O

The O
implementation O
of O
these O
techniques O
has O
some O
unique O
idiosyncrasies O
that O
permit O
direct O
attribution O
to O
the O
source O
code O
Steven O
Lai O
posted O
. O

First O
, O
a O
malware O
family O
is O
a O
collection O
of O
malware O
in O
which O
each O
sample O
shares O
a O
significant O
amount O
of O
code O
with O
all O
of O
the O
others O
. O

An O
option O
for O
'' O
Device O
Targeting O
'' O
is O
now O
available O
under O
'' O
Targeting O
'' O
. O

This B-Entity
third I-Entity
component I-Entity
is B-Action
likely I-Action
used I-Action
for B-Modifier
long-term O
implantation O
and O
intelligence B-Entity
gathering I-Entity
. O

We O
make O
the O
following O
contributions O
: O
• O
We O
analyze O
the O
technology O
associated O
with O
targeted O
at- O
tacks O
( O
e.g. O
, O
malicious O
links O
, O
spyware O
) O
, O
and O
trace O
it O
back O
to O
its O
programmers O
and O
manufacturers O
. O

A B-Entity
120-minute I-Entity
( I-Entity
2 I-Entity
hour I-Entity
) I-Entity
sleep I-Entity
command I-Entity
is B-Action
issued I-Action
after O
which O
the B-Entity
computer I-Entity
is B-Action
shut I-Action
down I-Action
and I-Action
rebooted I-Action
. O

We O
alerted O
the O
owner O
of O
www.getmedia.us O
, O
who O
removed O
the O
payloads O
. O

The O
method O
has O
one O
major O
drawback O
: O
it O
will O
also O
infect O
third O
parties O
who O
visit O
the O
website O
. O

Next O
, O
it B-Entity
calculates B-Action
and I-Action
confirms I-Action
a B-Entity
CRC32 I-Entity
checksum I-Entity
within B-Modifier
the B-Entity
command I-Entity
, O
further O
decrypts B-Action
the B-Entity
data I-Entity
by B-Modifier
using B-Entity
the I-Entity
Number I-Entity
Theory I-Entity
Library I-Entity
( I-Entity
NTL I-Entity
) I-Entity
, O
and O
makes B-Action
sure I-Action
the B-Entity
command I-Entity
is I-Entity
destined I-Entity
to I-Entity
the I-Entity
current I-Entity
host I-Entity
by B-Modifier
matching B-Entity
the I-Entity
ID I-Entity
field I-Entity
in I-Entity
it I-Entity
. O

] O
com O
. O

Their B-Entity
filenames I-Entity
contained B-Action
a B-Entity
Uni- I-Entity
code I-Entity
right-to-left I-Entity
override I-Entity
( I-Entity
RLO I-Entity
) I-Entity
character I-Entity
, O
causing B-Action
Windows B-Entity
to I-Entity
render I-Entity
a I-Entity
filename I-Entity
such I-Entity
as I-Entity
gpj.1bajaR.exe I-Entity
instead I-Entity
as I-Entity
exe.Rajab1.jpg I-Entity
. O

Focused O
on O
domestic O
order O
, O
it O
oversees O
North O
Korea O
's O
national O
police O
force O
, O
conducts O
criminal O
investigations O
and O
preliminary O
examinations O
, O
and O
oversees O
correctional O
facilities O
, O
excluding O
prison O
camps O
. O

In O
some O
cases O
the B-Entity
attackers I-Entity
employed B-Action
expensive B-Entity
and I-Entity
'' I-Entity
government I-Entity
exclusive I-Entity
'' I-Entity
malware I-Entity
, O
while O
in O
other O
cases O
, O
attackers B-Entity
used B-Action
cheap B-Entity
and I-Entity
readily I-Entity
available I-Entity
RATs I-Entity
. O

The O
registration O
lists O
VPSNOC O
as O
the O
registrant O
organization O
, O
abunasar O
@ O
yahoo.com O
as O
the O
registration O
email O
address O
, O
and O
House O
12 O
, O
Street O
21 O
, O
F-8/1 O
Islamabad O
Federal O
44000 O
as O
the O
registration O
address O
. O

In O
a O
previous O
investigation O
, O
Art O
of O
Deterrence O
techniques O
were O
successfully O
used O
to O
divert O
Indonesian O
hackers O
motivated O
by O
monetary O
gain O
away O
from O
their O
highest O
yielding O
target O
group O
. O

In O
addition O
, O
the B-Entity
malware I-Entity
uses B-Action
the B-Entity
old I-Entity
PKWARE I-Entity
implementation I-Entity
of I-Entity
zip I-Entity
encryption I-Entity
, O
which O
is O
not O
particularly O
secure O
. O

The O
configuration O
block O
usually O
contains O
two O
hard-coded O
C O
& O
C O
URLs O
. O

Research O
presented O
in O
this O
report O
shows O
that O
the O
PUTTER O
PANDA O
operators O
are O
likely O
members O
of O
the O
12th O
Bureau O
, O
3rd O
General O
Staff O
Department O
( O
GSD O
) O
of O
the O
People O
's O
Liberation O
Army O
( O
PLA O
) O
, O
operating O
from O
the O
unit O
's O
headquarters O
in O
Shanghai O
with O
MUCD O
61486 O
. O

North O
Korea O
also O
claims O
to O
be O
the O
sole O
government O
of O
the O
Korean O
Peninsula O
. O

The O
result O
: O
nine O
people O
lost O
their O
lives O
. O

While O
the O
exact O
reason O
why O
some O
hotels O
function O
as O
an O
attacker O
vector O
are O
unknown O
, O
certain O
suspicions O
ex- O
ist O
, O
indicating O
possibly O
a O
much O
larger O
compromise O
. O

When B-Modifier
the B-Entity
data I-Entity
arrives I-Entity
, O
it B-Entity
is B-Action
intercepted I-Action
with B-Modifier
the B-Entity
FwpsCopyStreamDataToBuffer0 I-Entity
( I-Entity
) I-Entity
API I-Entity
, O
and O
then O
scanned B-Action
for B-Modifier
the B-Entity
presence I-Entity
of I-Entity
the I-Entity
hidden I-Entity
commands I-Entity
from I-Entity
C I-Entity
& I-Entity
C I-Entity
. O

• O
The O
infrastructure O
utilized O
in O
the O
campaign O
is O
too O
significant O
to O
be O
a O
lone O
individual O
or O
a O
small O
group O
. O

These B-Entity
attacks I-Entity
were O
debilitating O
and O
impacted B-Action
the B-Entity
availability I-Entity
of I-Entity
online I-Entity
banking I-Entity
services I-Entity
. O

The B-Entity
remote I-Entity
process I-Entity
is B-Action
started I-Action
via B-Modifier
the B-Entity
command I-Entity
'' I-Entity
cmd.exe I-Entity
/c I-Entity
wmic.exe I-Entity
/node I-Entity
: I-Entity
hostname I-Entity
/user I-Entity
: I-Entity
username I-Entity
/password I-Entity
: I-Entity
pass I-Entity
PROCESS I-Entity
CALL I-Entity
CREATE I-Entity
'' I-Entity
. O

In O
this O
is O
example O
the O
key O
would O
be O
: O
30 O
ac O
e5 O
21 O
e4 O
a6 O
. O

This O
section O
describes O
how O
the O
driver O
performs O
its O
initialization O
routine O
. O

Similarly O
, O
activity O
observed O
by O
the O
authors O
also O
dwindled O
prior O
to O
expectation O
of O
US-led O
military O
action O
against O
Syrian O
government O
targets O
in O
September O
2013 O
. O

In O
the O
same O
interview O
Clément O
says O
that O
the O
computers O
targeted O
by O
the O
attackers O
included O
staff O
workstations O
as O
well O
as O
email O
servers O
. O

Since O
the O
functionality O
of O
these O
tools O
was O
partly O
overlapping O
with O
that O
of O
Korplug O
, O
it O
left O
us O
wondering O
whether O
the O
attackers O
were O
just O
experimenting O
with O
different O
RATs O
or O
were O
they O
supplementing O
some O
functionality O
that O
they O
were O
unable O
to O
accomplish O
. O

This O
attack O
evolved O
to O
appear O
more O
legitimate O
. O

For O
SMTP O
traffic O
, O
it O
communicates O
back O
normal O
SMTP O
server O
responses O
, O
such O
as O
'' O
250 O
Sender O
OK O
'' O
, O
'' O
503 O
Bad O
sequence O
of O
commands O
'' O
, O
etc O
. O

Neustar O
offers O
a O
full O
service O
ad O
network O
. O

What O
we O
have O
seen O
in O
Regin O
is O
just O
such O
a O
class O
of O
malware O
. O

The B-Entity
malware I-Entity
exfiltrates B-Action
to B-Modifier
an B-Entity
online I-Entity
e-mail I-Entity
account I-Entity
, O
thus O
not O
requiring O
the O
attacker O
to O
maintain O
a O
command-and- O
control O
server O
online O
. O

We O
discovered O
that O
40 O
out O
of O
the O
50 O
compromised O
websites O
, O
spread O
across O
13 O
IP O
addresses O
, O
are O
hosted O
on O
a O
single O
cloud-hosting O
service O
based O
in O
Japan O
. O

Other O
domains O
seen O
resolving O
to O
IP O
address O
nearby O
include O
the O
following O
: O
Aside O
from O
the B-Entity
sample I-Entity
connecting B-Action
to B-Modifier
plugin- B-Entity
adobe I-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
, O
we O
have O
not O
discovered O
any O
malware O
connecting O
to O
these O
domains O
. O

One O
example O
is O
Unikotech O
, O
which O
was O
formed O
to O
sell O
KCC O
products O
abroad O
. O

This B-Entity
file I-Entity
is B-Action
then I-Action
further I-Action
encrypted I-Action
with B-Modifier
an B-Entity
NTL-based I-Entity
( I-Entity
Number I-Entity
Theory I-Entity
Library I-Entity
) I-Entity
algorithm I-Entity
and O
is B-Action
uploaded I-Action
by B-Modifier
the B-Entity
usermode-centric I-Entity
Snake I-Entity
rootkit I-Entity
to B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
, O
along B-Modifier
with I-Modifier
other B-Entity
configuration I-Entity
files I-Entity
, I-Entity
such I-Entity
as I-Entity
mtmon.sdb I-Entity
, I-Entity
mtmon32.sdb I-Entity
, I-Entity
gstatsnd.bin I-Entity
, I-Entity
gstat.bin I-Entity
, I-Entity
gstat32.bin I-Entity
, I-Entity
and I-Entity
other I-Entity
log I-Entity
files I-Entity
found I-Entity
in I-Entity
the I-Entity
% I-Entity
windows I-Entity
% I-Entity
\ I-Entity
$ I-Entity
NtUninstallQ I-Entity
[ I-Entity
random I-Entity
] I-Entity
$ I-Entity
directory I-Entity
. O

For O
example O
, O
analysis O
of O
files O
deployed O
alongside O
the O
nulled-out O
'' O
Cert-India O
'' O
sample O
mentioned O
above O
revealed O
a O
lack O
of O
concern O
over O
the O
same O
string O
. O

All B-Entity
three I-Entity
samples I-Entity
provided B-Action
remote B-Entity
access I-Entity
to B-Modifier
the B-Entity
attacker I-Entity
, O
via B-Modifier
two B-Entity
Command I-Entity
and I-Entity
Control I-Entity
( I-Entity
C2 I-Entity
) I-Entity
servers I-Entity
. O

Of O
the O
attachments O
, O
1,588 O
had O
a O
.exe O

We O
believe O
that O
Tranchulas O
may O
have O
obtained O
information O
about O
TCIRT O
's O
notification O
to O
VPSNOC O
through O
a O
pre-established O
relationship O
. O

Here O
's O
an O
example O
of O
a B-Entity
targeted I-Entity
spear-phishing I-Entity
e-mail I-Entity
directed B-Action
at B-Modifier
Uyghur B-Entity
activists I-Entity
in B-Modifier
March B-Entity
2014 I-Entity
. O

RSS O
operates O
in O
territory O
controlled O
by O
ISIS O
, O
and O
has O
faced O
extensive O
targeting O
by O
ISIS O
. O

This O
version O
was O
not O
obfuscated O
with O
SmartAssembly O
We O
do O
not O
see O
a O
new O
version O
of O
TinyZBot O
until O
June O
7 O
, O
2014 O
. O

) O
The B-Entity
POST I-Entity
body I-Entity
is B-Action
now I-Action
encoded I-Action
. O

Under O
the O
ramfs O
mounted O
partition O
we O
found O
a O
stripped O
and O
statically O
linked O
MIPS-el O
binary O
named O
tail- O
. O

European O
privacy O
laws O
for O
forcing O
most O
ad O
providers O
to O
offer O
the O
opt-out O
service O
; O
however O
, O
you O
often O
have O
to O
visit O
each O
ad O
provider O
individually O
to O
choose O
to O
opt O
out O
. O

However O
, O
if O
the O
attacker O
were O
interested O
in O
unmasking O
the O
location O
of O
its O
targets O
so O
they O
could O
be O
physically O
tracked O
down O
, O
collecting O
IP O
data O
and O
system O
info O
would O
be O
a O
more O
reasonable O
approach O
. O

• O
APT28 B-Entity
has O
employed B-Action
RSA B-Entity
encryption I-Entity
to B-Modifier
protect B-Entity
files I-Entity
and I-Entity
stolen I-Entity
information I-Entity
moved I-Entity
from I-Entity
the I-Entity
victim I-Entity
's I-Entity
network I-Entity
to I-Entity
the I-Entity
controller I-Entity
. O

Yet O
more O
backlash O
was O
witnessed O
with O
FireEye's O
exposure O
of O
Operation O
Saffron O
Rose O
, O
an O
espionage O
campaign O
executed O
by O
the O
Ajax O
Security O
Team O
in O
2014 O
. O

Its O
encryption O
algorithm O
is O
similar O
to O
RC4 O
. O

Once O
decrypted O
, O
the B-Entity
malware I-Entity
interprets B-Action
the B-Entity
received I-Entity
command I-Entity
, O
as O
reflected O
in O
the O
malware O
log O
below O
( O
the O
new O
C O
& O
C O
server O
address O
is O
highlighted O
in O
it O
) O
: O
After O
that O
, O
the B-Entity
malware I-Entity
connects B-Action
to B-Modifier
the B-Entity
new I-Entity
C I-Entity
& I-Entity
C I-Entity
, O
asking B-Action
it B-Entity
for B-Modifier
another B-Entity
command I-Entity
: O
The B-Entity
command I-Entity
it B-Entity
receives B-Action
is O
called O
UpLoad O
, O
so O
it B-Entity
uploads B-Action
all B-Entity
the I-Entity
collected I-Entity
logs I-Entity
to B-Modifier
the B-Entity
server I-Entity
, O
and O
then O
cleans B-Action
out I-Action
those B-Entity
logs I-Entity
: O
The B-Entity
files I-Entity
it B-Entity
uploads B-Action
are O
stored O
inside O
its O
home O
directory O
% O
windows O
% O
\ O
$ O
NtUninstallQ O
[ O
random O
] O
$ O
, O
where O
[ O
random O
] O
is O
a O
random O
number O
. O

BITTERBUG B-Entity
then O
may O
attempt O
to O
download B-Action
the B-Entity
files I-Entity
listed I-Entity
in I-Entity
Table I-Entity
1 I-Entity
. O

The O
most O
notable O
vulnerability O
is O
the O
Microsoft O
Windows O
Shortcut O
'LNK/PIF O
' O
Files O
Automatic O
File O
Execution O
Vulnerability O
( O
CVE-2010-2568 O
) O
, O
which O
allows O
it O
to O
auto-execute O
on O
USB O
drives O
. O

Other O
malware O
used O
for O
Operation O
Troy O
was O
also O
planted O
. O

After O
decompiling O
the O
shell O
client O
, O
we O
found O
the O
following O
code O
segment O
controlling O
the O
display O
of O
this O
IP O
location O
information O
. O

The O
following O
malicious O
domains O
are O
operated O
by O
this O
organization O
and O
are O
grouped O
by O
the O
registrant O
's O
email O
address O
. O

The B-Entity
first I-Entity
résumé I-Entity
submission I-Entity
form I-Entity
requests B-Action
contact B-Entity
information I-Entity
. O

First O
version O
of O
the O
Gen O
2.0 O
Alpha O
malware O
, O
from O
28 O
August O
2011 O
, O
has O
the O
PDB O
path O
located O
in O
H O
: O
\JmVodServer\Matrixnew2 O
whereas O
the O
file O
path O
for O
later O
Gen O
2.0 O
Alpha O
and O
Gen O
2.0 O
Beta O
binaries O
has O
the O
PDB O
path O
in O
E O
: O
\SourceCode\Matrixnew O
which O
suggests O
that O
the O
source O
code O
for O
both O
Gen O
1 O
and O
Gen O
2 O
existed O
on O
the O
same O
machine O
and O
moved O
at O
roughly O
the O
same O
time O
. O

On O
6/25/13 O
, O
Ali O
was O
sentenced O
to O
one O
year O
in O
prison O
. O

Those O
reading O
the O
indictment O
should O
not O
conclude O
that O
the O
People O
's O
Republic O
of O
China O
( O
PRC O
) O
hacking O
campaign O
is O
limited O
to O
five O
soldiers O
in O
one O
military O
unit O
, O
or O
that O
they O
solely O
target O
the O
United O
States O
government O
and O
corporations O
. O

Many O
Android O
functionalities O
, O
especially O
remote O
call O
invocations O
, O
are O
encapsulated O
in O
the O
context O
. O

If O
the O
event O
already O
exists O
, O
the B-Entity
driver I-Entity
fails O
to O
load O
, O
presumably O
to O
avoid B-Action
a O
multiple B-Entity
instances I-Entity
of I-Entity
itself I-Entity
. O

While O
the O
relationship O
between O
actors O
such O
as O
the O
Ajax O
Security O
Team O
and O
the O
Iranian O
government O
is O
unknown O
, O
their O
activities O
appear O
to O
align O
with O
Iranian O
government O
political O
objectives O
. O

The O
impact O
of O
the B-Entity
March I-Entity
20 I-Entity
attacks I-Entity
included B-Action
disruption B-Entity
of I-Entity
service I-Entity
at I-Entity
financial I-Entity
institutions I-Entity
and O
data B-Entity
deletion I-Entity
. O

In O
the O
most O
common O
attack O
sequence O
we O
observed O
, O
illus- O
trated O
with O
three O
examples O
in O
Figure O
3 O
, O
the B-Entity
attacker I-Entity
seeds B-Action
mal- B-Entity
ware I-Entity
via B-Modifier
private B-Entity
chat I-Entity
messages I-Entity
, I-Entity
posts I-Entity
in I-Entity
opposition-controlled I-Entity
social I-Entity
media I-Entity
groups I-Entity
, I-Entity
or I-Entity
e-mail I-Entity
. O

In O
2013 O
, O
a O
member O
of O
RAONASRT O
was O
invited O
to O
Blue O
House O
, O
the O
residence O
of O
the O
South O
Korean O
president O
, O
to O
meet O
with O
president O
Park O
and O
discuss O
the O
security O
industry O
. O

] O
org O
, O
which O
is O
registered O
to O
info O
@ O
usa.gov O
[ O
. O

Based O
on O
infrastructure O
overlaps O
and O
tradecraft O
similarities O
, O
we O
believe O
the O
actors O
behind O
this O
campaign O
are O
associated O
with O
two O
previously O
identified O
campaigns O
( O
Operation O
DeputyDog O
and O
Operation O
Ephemeral O
Hydra O
) O
. O

Overall O
, O
we O
see O
a O
trend O
of O
the O
attacker O
conducting O
more O
focused O
attacks O
against O
fewer O
individuals O
. O

The O
message O
was O
carefully O
worded O
, O
and O
contained O
references O
specific O
to O
the O
work O
and O
interests O
of O
RSS O
. O

Output O
from O
MimikatzWrapper O
is O
essentially O
the O
same O
as O
zhMimikatz O
, O
despite O
being O
a O
different O
Visual O
Studio O
project O
. O

Alireza O
's O
C O
# O
tools O
include O
the O
following O
techniques O
: O
Alireza O
's O
Java O
tools O
include O
the O
following O
techniques O
: O
Alireza O
's O
C++ O
tools O
include O
the O
following O
techniques O
: O
kaJ O
is O
a O
.NET O

It O
is O
likely O
that O
SOAP B-Entity
was O
used O
because O
it O
is O
simple O
to O
implement O
in O
C O
# O
, O
and O
has O
the O
added O
benefit O
of O
blending B-Action
in I-Action
with B-Modifier
other B-Entity
benign I-Entity
HTTP I-Entity
traffic I-Entity
. O

cardmagic O
writes O
: O
Windows O
Vista O
has O
changed O
alot O
on O
network O
module O
, O
many O
old O
port O
hiding O
materials O
are O
no O
longer O
usable O
. O

This O
code O
appears O
to O
have O
been O
compiled O
on O
Thursday O
May O
26th O
, O
2011 O
at O
10:21:44 O
A.M. O
UTC O
( O
early O
evening O
time O
in O
China O
) O
. O

• O
Networks O
and O
systems O
targeted O
in O
critical O
industries O
like O
energy O
and O
utilities O
, O
oil O
and O
gas O
, O
and O
chemical O
companies O
. O

Some O
samples O
contain O
a O
digital O
signature O
by O
'' O
Nanning O
weiwu O
Technology O
co. O
, O
ltd O
'' O
. O

The O
last O
known O
Gen O
1.2 O
sample O
, O
and O
by O
extension O
, O
the O
last O
known O
Gen O
1 O
sample O
, O
dates O
to O
9 O
April O
2012 O
. O

Combined O
with O
the O
launcher O
modification O
attack O
introduced O
earlier O
, O
the B-Entity
attackers I-Entity
can O
redirect B-Action
other B-Entity
app I-Entity
icons I-Entity
( I-Entity
e.g. I-Entity
, I-Entity
bank I-Entity
or I-Entity
email I-Entity
app I-Entity
icons I-Entity
) I-Entity
to B-Modifier
the B-Entity
phishing I-Entity
app I-Entity
and O
steal B-Action
the B-Entity
user I-Entity
's I-Entity
login I-Entity
credentials I-Entity
. O

The B-Entity
malware I-Entity
transmits B-Action
autonomously O
, O
leaving B-Action
the B-Entity
material I-Entity
in B-Modifier
an B-Entity
inbox I-Entity
for B-Modifier
the B-Entity
attacker I-Entity
to I-Entity
collect I-Entity
at I-Entity
a I-Entity
later I-Entity
time I-Entity
. O

It O
should O
also O
be O
noted O
that O
23 O
percent O
were O
Microsoft O
Word O
documents O
using O
some O
exploit O
to O
execute O
custom O
code O
on O
the O
computer O
. O

This O
report O
contains O
details O
on O
the O
tactics O
, O
tools O
, O
and O
techniques O
used O
by O
PUTTER O
PANDA O
, O
and O
provides O
indicators O
and O
signatures O
that O
can O
be O
leveraged O
by O
organizations O
to O
protect O
themselves O
against O
this O
activity O
. O

The O
modularity O
of O
CHOPSTICK O
alone O
, O
with O
its O
flexible O
and O
lasting O
platform O
, O
demonstrates O
planning O
for O
long-term O
use O
and O
versatility O
. O

In O
the O
second O
half O
of O
2012 O
, O
the O
energy O
sector O
was O
the O
second O
most O
targeted O
with O
16 O
percent O
of O
all O
the O
targeted O
attacks O
. O

Net B-Entity
Crawler I-Entity
utilizes B-Action
a B-Entity
cached I-Entity
credential I-Entity
dumping I-Entity
technique I-Entity
along B-Modifier
with I-Modifier
PsExec B-Entity
in O
order O
to O
worm B-Action
throughout B-Modifier
a B-Entity
network I-Entity
, O
collecting B-Action
any B-Entity
and I-Entity
all I-Entity
credentials I-Entity
that I-Entity
it I-Entity
can I-Entity
extract I-Entity
from I-Entity
credential I-Entity
caches I-Entity
. O

The O
legitimate O
application O
included O
in O
this O
binder O
is O
called O
Easyresumecreator O
and O
is O
a O
legitimate O
application O
named O
EasyRésuméCreatorPro O
. O

All B-Entity
of I-Entity
the I-Entity
emails I-Entity
contained B-Action
the B-Entity
same I-Entity
Trojan.Dropper I-Entity
disguised B-Action
as B-Modifier
an B-Entity
attachment I-Entity
with I-Entity
the I-Entity
filename I-Entity
AVP.dll I-Entity
. O

Based O
on O
his O
websites O
and O
account O
information O
, O
he O
appears O
to O
have O
an O
interest O
or O
participated O
in O
the O
Antisec O
and O
Anonymous O
movements O
( O
Figure O
8 O
) O
. O

Furthermore O
, O
the B-Entity
attackers I-Entity
can O
exploit B-Action
several B-Entity
Android I-Entity
vulnerabilities I-Entity
to B-Modifier
get B-Entity
valuable I-Entity
private I-Entity
information I-Entity
or O
to B-Modifier
launch B-Entity
more I-Entity
advanced I-Entity
attacks I-Entity
. O

• O
The O
name O
of O
the O
group O
in O
Persian O
, O
the O
year O
in O
which O
it O
was O
founded O
and O
a O
passage O
from O
the O
Qur'an O
( O
8:60 O
) O
'And O
make O
ready O
against O
them O
all O
you O
can O
of O
power O
' O
, O
are O
represented O
in O
text O
. O

There O
is O
a O
missing O
space O
in O
the O
MediaPlayer O
directory O
and O
the O
filename O
is O
missing O
the O
'o O
' O
character O
. O

Ali O
's O
case O
is O
an O
example O
of O
the O
larger O
phenomenon O
we O
in- O
vestigate O
: O
attacks O
against O
activists O
, O
dissidents O
, O
trade O
unionists O
, O
human O
rights O
campaigners O
, O
journalists O
, O
and O
members O
of O
NGOs O
( O
henceforth O
'' O
targets O
'' O
) O
in O
the O
Middle O
East O
. O

Based O
on O
registration O
data O
and O
folder O
configuration O
we O
believe O
these O
are O
legitimate O
but O
compromised O
Joomla O
servers O
. O

This O
top O
level O
country O
code O
domain O
is O
quite O
exotic O
and O
is O
assigned O
to O
Pitcairn O
Islands O
, O
which O
is O
Overseas O
ter- O
ritory O
of O
the O
United O
Kingdom O
in O
the O
Pacific O
. O

Some O
of O
the O
malware O
samples O
were O
no O
longer O
publicly O
available O
. O

As O
noted O
above O
, O
this B-Entity
site I-Entity
has O
been B-Action
targeted I-Action
with B-Modifier
a B-Entity
DDoS I-Entity
attack I-Entity
by O
a B-Entity
KernelBot I-Entity
network I-Entity
. O

As O
of O
2014 O
, O
IP O
addresses O
175.45.176.0 O
- O
175.45.177.255 O
appear O
to O
be O
used O
for O
websites O
, O
nameservers O
, O
databases O
, O
email O
, O
and O
voice O
over O
IP O
( O
VoIP O
) O
. O

We O
suspects O
threat O
actors O
sought O
to O
monitor O
these O
programs O
and O
involved O
individuals O
. O

The O
plugins O
for O
the O
Carbon O
system O
can O
be O
easily O
recognized O
as O
they O
always O
feature O
at O
least O
two O
exports O
named O
: O
Several O
Epic O
backdoors O
appear O
to O
have O
been O
designed O
to O
work O
as O
Carbon O
system O
plugins O
as O
well O
- O
they O
require O
a O
specialized O
loader O
to O
start O
in O
victim O
systems O
that O
do O
not O
have O
the O
Carbon O
system O
deployed O
. O

Immediately O
following O
the O
header O
is O
the O
type-specific O
( O
as O
indicated O
by O
the O
dwPayloadType O
field O
) O
payload O
data O
. O

During O
our O
regular O
investigations O
on O
APT O
cases O
, O
one O
particular O
variant O
of O
malware O
caught O
our O
attention O
, O
because O
we O
had O
not O
faced O
it O
before O
. O

Citizen O
Lab O
research O
into O
targeted O
digital O
threats O
against O
civil O
society O
confirms O
that O
civil O
society O
groups O
face O
grave O
threats O
from O
targeted O
malware O
attacks O
, O
despite O
being O
under-resourced O
to O
defend O
against O
them O
. O

The B-Entity
left I-Entity
panel I-Entity
enables B-Action
the B-Entity
attacker I-Entity
to B-Modifier
command B-Entity
the I-Entity
victim I-Entity
's I-Entity
device I-Entity
, O
including O
uploading B-Action
local B-Entity
files I-Entity
, O
taking B-Action
pictures B-Entity
, O
recording B-Action
audio/video B-Entity
, O
manipulating B-Action
the B-Entity
clipboard I-Entity
, O
sending B-Action
SMS B-Entity
, O
dialing B-Action
numbers B-Entity
, O
implanting B-Action
bootkit B-Entity
, O
or O
installing B-Action
the B-Entity
attacker I-Entity
's I-Entity
apps I-Entity
uploaded I-Entity
to I-Entity
Google I-Entity
Play I-Entity
, O
etc O
. O

CHOPSTICK B-Entity
collects B-Action
detailed B-Entity
information I-Entity
from B-Modifier
the B-Entity
host I-Entity
including O
the B-Entity
Windows I-Entity
version I-Entity
, O
CPU B-Entity
architecture I-Entity
, O
Windows B-Entity
Firewall I-Entity
state I-Entity
, O
User B-Entity
Account I-Entity
Control I-Entity
( I-Entity
UAC I-Entity
) I-Entity
configuration I-Entity
settings I-Entity
on I-Entity
Windows I-Entity
Vista I-Entity
and I-Entity
above I-Entity
and O
Internet B-Entity
Explorer I-Entity
settings I-Entity
. O

For O
example O
, O
we O
have O
seen O
attackers O
target O
intellectual O
property O
such O
as O
technology O
for O
photovoltaic O
research O
and O
wind O
turbines O
, O
or O
data O
on O
gas O
field O
exploration O
. O

• O
This O
campaign O
could O
be O
a O
way O
to O
demonstrate O
Iran O
's O
cyber O
capabilities O
for O
additional O
geopolitical O
leverage O
, O
due O
to O
the O
breadth O
and O
depth O
of O
their O
global O
targets O
. O

The B-Entity
following I-Entity
command I-Entity
and I-Entity
control I-Entity
servers I-Entity
for I-Entity
Logger I-Entity
Module I-Entity
have O
been B-Action
observed I-Action
: O
WndTest O
is O
the O
evolution O
of O
the O
PVZ O
tool O
chain O
into O
a O
single O
executable O
. O

Here O
is O
how O
the O
export O
address O
table O
of O
the O
patched O
binary O
looks O
after O
modifications O
. O

These O
domains O
were O
registered O
to O
an O
address O
corresponding O
to O
the O
physical O
location O
of O
the O
Shanghai O
headquarters O
of O
12th O
Bureau O
, O
specifically O
Unit O
61486 O
. O

It B-Entity
also O
is O
able O
to O
bypass B-Action
User B-Entity
Account I-Entity
Control I-Entity
( I-Entity
UAC I-Entity
) I-Entity
to B-Modifier
install B-Entity
itself I-Entity
by I-Entity
using I-Entity
the I-Entity
'sysprep.exe I-Entity
' I-Entity
Microsoft I-Entity
Windows I-Entity
executable I-Entity
provided I-Entity
by I-Entity
the I-Entity
targeted I-Entity
system I-Entity
. O

The B-Entity
attacker I-Entity
can O
bind B-Action
the B-Entity
backdoor I-Entity
to B-Modifier
a B-Entity
legitimate I-Entity
application I-Entity
of I-Entity
his I-Entity
or I-Entity
her I-Entity
choosing I-Entity
, O
or O
they B-Entity
can O
cloak B-Action
it B-Entity
with B-Modifier
an B-Entity
icon I-Entity
designed I-Entity
to I-Entity
make I-Entity
the I-Entity
backdoor I-Entity
appear I-Entity
as I-Entity
though I-Entity
it I-Entity
is I-Entity
a I-Entity
legitimate I-Entity
file I-Entity
. O

It O
was O
spread O
throughout O
2014 O
. O

Again O
, O
it O
seems O
that O
the O
actors O
responsible O
for O
the O
attack O
borrowed O
the O
moniker O
of O
another O
group O
. O

Once O
targeted O
, O
an O
end O
user O
only O
needed O
to O
browse O
to O
any O
website O
, O
anywhere O
in O
the O
world O
, O
which O
contained O
a O
DoubleClick O
ad-partner O
embedded O
window O
. O

While O
the O
user O
is O
browsing O
the O
compromised O
website O
, O
all B-Entity
keystrokes I-Entity
are O
being B-Action
recorded I-Action
and O
sent B-Action
to B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
periodically B-Entity
. O

The O
malware O
uses O
text O
protocol O
, O
which O
is O
why O
potentially O
binary O
values O
of O
< O
UserId O
> O
and O
< O
GeneralSysInfo O
> O
are O
ad- O
ditionally O
encoded O
using O
Base64 O
algorithm O
. O

Credentials B-Entity
for I-Entity
the I-Entity
following I-Entity
applications I-Entity
are B-Action
collected I-Action
: O
Both O
email B-Entity
and O
HTTP B-Entity
can O
be B-Action
used I-Action
to B-Modifier
send B-Entity
out I-Entity
the I-Entity
collected I-Entity
credentials I-Entity
. O

This O
vulnerability O
affects O
Microsoft O
Office O
versions O
up O
to O
Office O
2010 O
. O

In O
order O
to O
accomplish O
this O
task O
, O
the O
newly O
created O
thread O
initializes O
networking O
APIs O
using O
WSAStartup O
( O
) O
and O
resolves O
some O
other O
APIs O
dynamically O
using O
LoadLibrary O
( O
) O
and O
GetProcAddress O
( O
) O
. O

Given O
that O
the O
identities O
and O
locations O
of O
RSS O
members O
are O
closely O
guarded O
, O
such O
information O
would O
hold O
significant O
intelligence O
value O
for O
ISIS O
. O

South O
Korea O
's O
constitution O
legally O
defines O
South O
Korean O
territory O
as O
the O
entire O
Korean O
peninsula O
and O
its O
adjacent O
islands O
, O
with O
'' O
North O
Korea O
'' O
being O
a O
part O
of O
South O
Korea O
. O

Whether O
citizens O
are O
allowed O
to O
access O
the O
Internet O
from O
this O
location O
is O
unknown O
. O

These O
other O
commands O
contain O
functionality O
to O
: O
• O
Pause O
C2 O
activity O
for O
a O
random O
time O
interval O
. O

( O
July O
) O
 O
North O
Korea O
states O
that O
it O
is O
'' O
fully O
ready O
for O
any O
form O
of O
high-tech O
war O
. O

At O
McAfee O
, O
McClure O
held O
numerous O
positions O
including O
SVP/General O
Manager O
for O
the O
Security O
Management O
BU O
as O
well O
as O
EVP/Global O
Chief O
Technology O
Officer O
responsible O
for O
almost O
$ O
3B O
worth O
of O
revenues O
. O

The O
growing O
U.S.-Georgian O
military O
relationship O
has O
been O
a O
source O
of O
angst O
for O
Russia O
. O

The O
elite O
cyber O
operators O
are O
given O
special O
incentives O
. O

If O
networks O
are O
truly O
segregated O
, O
this O
would O
mean O
that O
there O
would O
be O
no O
software O
updates O
installed O
, O
leaving O
old O
vulnerabilities O
open O
. O

files O
include O
raw O
SMTP O
headers O
, O
content O
and O
attachments O
. O

In O
some O
cases O
, O
the B-Entity
backdoor I-Entity
is O
packaged O
together O
with O
the O
CVE-2013-5065 O
EoP O
exploit O
and O
heavily O
obfuscated B-Action
. O

This O
vulnerability O
occurred O
in O
parsing O
RTF O
files O
and O
was O
assigned O
CVE-2014-1761 O
, O
a O
thorough O
analysis O
of O
which O
can O
be O
found O
on O
the O
HP O
Security O
Research O
blog O
. O

Each O
16 O
byte O
request O
header O
consists O
of O
: O
Zero O
or O
more O
of O
specified O
bytes O
of O
additional O
payload O
then O
follows O
the O
header O
. O

The O
names O
of O
the O
files O
both O
when O
dropped O
and O
their O
original O
names O
along O
with O
the O
callback O
directories O
, O
paths O
and O
mutexes O
used O
all O
seem O
to O
be O
dynamically O
generated O
. O

The O
attackers O
also O
constructed O
a O
ba- O
sic O
, O
faux O
GUI O
for O
their O
'' O
Encryption O
'' O
program O
( O
see O
Figure O
4 O
) O
. O

Half O
of O
all O
the O
attachments O
analyzed O
used O
an O
extension O
that O
would O
run O
directly O
when O
double O
clicked O
. O

During O
our O
investigation O
, O
we O
discovered O
that O
these B-Entity
attackers I-Entity
sent B-Action
targeted B-Entity
emails I-Entity
, I-Entity
as I-Entity
well I-Entity
as I-Entity
private I-Entity
messages I-Entity
through B-Modifier
social B-Entity
media I-Entity
. O

'' O
Could O
Malvertisers O
Track O
Exploits O
and O
their O
cost O
per O
impression O
? O
Yes O
. O

Operation B-Entity
Cleaver I-Entity
has O
, O
over O
the O
past O
several O
years O
, O
conducted B-Action
a B-Entity
significant I-Entity
global I-Entity
surveillance I-Entity
and I-Entity
infiltration I-Entity
campaign I-Entity
. O

This O
threat O
actor O
clearly O
seeks O
out O
and O
compromises O
websites O
of O
organizations O
related O
to O
international O
security O
policy O
, O
defense O
topics O
, O
and O
other O
non-profit O
sociocultural O
issues O
. O

The O
malware O
contains O
code O
which O
allows O
it B-Entity
to O
load B-Action
or O
memory-map B-Action
external B-Entity
modules I-Entity
that I-Entity
export I-Entity
the I-Entity
following I-Entity
functions I-Entity
: I-Entity
SendRawPacket I-Entity
, I-Entity
GetRawPacket I-Entity
, I-Entity
InitializeExp I-Entity
, I-Entity
DestroyExp I-Entity
, I-Entity
IsActiveChannel I-Entity
, I-Entity
GetChannelInfo I-Entity
, I-Entity
SetChannelInfo I-Entity
, I-Entity
Run I-Entity
, I-Entity
GetModuleInfo I-Entity
, I-Entity
GiveMessage I-Entity
, I-Entity
and I-Entity
TakeMessage I-Entity
. O

Some O
are O
available O
for O
purchase O
by O
any- O
one O
, O
in O
contrast O
to O
'' O
government O
only O
'' O
FinSpy O
and O
RCS O
. O

Meanwhile O
, O
'' O
Operation O
Save O
the O
Arctic O
'' O
targeted O
multiple O
oil O
companies O
around O
the O
globe O
in O
protest O
against O
drilling O
plans O
in O
the O
Arctic O
. O

This O
sample O
uses O
pool O
tags O
: O
'tnet O
, O
' O
and O
'KDTR O
' O
. O

On B-Modifier
failure B-Entity
, O
Stage B-Entity
2 I-Entity
is O
able O
to O
disinfect B-Action
the B-Entity
compromised I-Entity
device I-Entity
. O

Audience O
Targeting O
: O
Bid O
on O
the O
audiences O
most O
valuable O
to O
you O
. O

The O
Uriminzokkiri O
website O
, O
known O
for O
pushing O
juche O
ideology O
and O
anti-American O
and O
anti-South O
Korean O
messages O
, O
has O
accompanying O
social O
media O
profiles O
on O
YouTube O
, O
Google+ O
, O
and O
Facebook O
. O

There O
is O
a O
noticeable O
steep O
improvement O
over O
the O
code O
base O
of O
Gen O
1 O
Hikit O
family O
during O
its O
2011 O
development O
period O
. O

